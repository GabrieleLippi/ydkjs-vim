





<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
  <link rel="dns-prefetch" href="https://assets-cdn.github.com">
  <link rel="dns-prefetch" href="https://avatars0.githubusercontent.com">
  <link rel="dns-prefetch" href="https://avatars1.githubusercontent.com">
  <link rel="dns-prefetch" href="https://avatars2.githubusercontent.com">
  <link rel="dns-prefetch" href="https://avatars3.githubusercontent.com">
  <link rel="dns-prefetch" href="https://github-cloud.s3.amazonaws.com">
  <link rel="dns-prefetch" href="https://user-images.githubusercontent.com/">



  <link crossorigin="anonymous" media="all" integrity="sha512-/yZA7MGD9acBi5MmgjnivwjGeiNsmimsI/bhLlK7akrRuw+hMxNpJoQEMO9Zt0Nq6ZRu1m1NGV6r95Ib0zx7Qw==" rel="stylesheet" href="https://assets-cdn.github.com/assets/frameworks-1ca00d32d1a8adc78ae7bb6677410eb1.css" />
  <link crossorigin="anonymous" media="all" integrity="sha512-pHF1luoMSUFxvz63bW3jEbbifYl/pruHUw+kljThAPi2g0nhgMdvWj4bQRh4O8MYp9NR60XYcylaLXmYA8YXSw==" rel="stylesheet" href="https://assets-cdn.github.com/assets/github-5043b3d96d50b119b971c2cdde4e0a62.css" />
  
  
  <link crossorigin="anonymous" media="all" integrity="sha512-yiJlaqOzeTU+S1E7OWf1xHkAosW1l4Lum0URPcPeQqKjKdZuSb9JoS5h1Dn8vs5rmdGshJ8pTr/FWwGKHlr1SQ==" rel="stylesheet" href="https://assets-cdn.github.com/assets/site-f84f81f77b3e1a4462036783c13c150d.css" />
  

  <meta name="viewport" content="width=device-width">
  
  <title>You-Dont-Know-JS/ch6.md at master · getify/You-Dont-Know-JS · GitHub</title>
    <meta name="description" content="A book series on JavaScript. @YDKJS on twitter. Contribute to getify/You-Dont-Know-JS development by creating an account on GitHub.">
    <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub">
  <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
  <meta property="fb:app_id" content="1401488693436528">

    
    <meta property="og:image" content="https://avatars0.githubusercontent.com/u/150330?s=400&amp;v=4" /><meta property="og:site_name" content="GitHub" /><meta property="og:type" content="object" /><meta property="og:title" content="getify/You-Dont-Know-JS" /><meta property="og:url" content="https://github.com/getify/You-Dont-Know-JS" /><meta property="og:description" content="A book series on JavaScript. @YDKJS on twitter. Contribute to getify/You-Dont-Know-JS development by creating an account on GitHub." />

  <link rel="assets" href="https://assets-cdn.github.com/">
  
  <meta name="pjax-timeout" content="1000">
  
  <meta name="request-id" content="F993:37B6:49B60D7:77058DF:5BA8D2EC" data-pjax-transient>


  

  <meta name="selected-link" value="repo_source" data-pjax-transient>

      <meta name="google-site-verification" content="KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU">
    <meta name="google-site-verification" content="ZzhVyEFwb7w3e0-uOTltm8Jsck2F5StVihD0exw2fsA">
    <meta name="google-site-verification" content="GXs5KoUUkNCoaAZn7wPN-t01Pywp9M3sEjnt_3_ZWPc">

  <meta name="octolytics-host" content="collector.githubapp.com" /><meta name="octolytics-app-id" content="github" /><meta name="octolytics-event-url" content="https://collector.githubapp.com/github-external/browser_event" /><meta name="octolytics-dimension-request_id" content="F993:37B6:49B60D7:77058DF:5BA8D2EC" /><meta name="octolytics-dimension-region_edge" content="iad" /><meta name="octolytics-dimension-region_render" content="iad" />
<meta name="analytics-location" content="/&lt;user-name&gt;/&lt;repo-name&gt;/blob/show" data-pjax-transient="true" />



    <meta name="google-analytics" content="UA-3769691-2">


<meta class="js-ga-set" name="dimension1" content="Logged Out">



  

      <meta name="hostname" content="github.com">
    <meta name="user-login" content="">

      <meta name="expected-hostname" content="github.com">
    <meta name="js-proxy-site-detection-payload" content="Y2Q3ZWU3OTRlOGNiMDdjYmRmMjYyZTkyNjlmNWQ3ODJhODEyNjgyOTIwOTBmMWU5Y2JmN2ZiMzU3ZWNmYmQ3MHx7InJlbW90ZV9hZGRyZXNzIjoiMzEuMjcuMzguOTUiLCJyZXF1ZXN0X2lkIjoiRjk5MzozN0I2OjQ5QjYwRDc6NzcwNThERjo1QkE4RDJFQyIsInRpbWVzdGFtcCI6MTUzNzc5MDcwMSwiaG9zdCI6ImdpdGh1Yi5jb20ifQ==">

    <meta name="enabled-features" content="DASHBOARD_V2_LAYOUT_OPT_IN,EXPLORE_DISCOVER_REPOSITORIES,UNIVERSE_BANNER,MARKETPLACE_PLAN_RESTRICTION_EDITOR,QUOTE_MARKDOWN">

  <meta name="html-safe-nonce" content="9d56edfe16533c716aeb79815eb42822f4758b53">

  <meta http-equiv="x-pjax-version" content="48839070ece5a75b6db249504aa0072e">
  

      <link href="https://github.com/getify/You-Dont-Know-JS/commits/master.atom" rel="alternate" title="Recent Commits to You-Dont-Know-JS:master" type="application/atom+xml">

  <meta name="go-import" content="github.com/getify/You-Dont-Know-JS git https://github.com/getify/You-Dont-Know-JS.git">

  <meta name="octolytics-dimension-user_id" content="150330" /><meta name="octolytics-dimension-user_login" content="getify" /><meta name="octolytics-dimension-repository_id" content="14440270" /><meta name="octolytics-dimension-repository_nwo" content="getify/You-Dont-Know-JS" /><meta name="octolytics-dimension-repository_public" content="true" /><meta name="octolytics-dimension-repository_is_fork" content="false" /><meta name="octolytics-dimension-repository_network_root_id" content="14440270" /><meta name="octolytics-dimension-repository_network_root_nwo" content="getify/You-Dont-Know-JS" /><meta name="octolytics-dimension-repository_explore_github_marketplace_ci_cta_shown" content="false" />


    <link rel="canonical" href="https://github.com/getify/You-Dont-Know-JS/blob/master/this%20%26%20object%20prototypes/ch6.md" data-pjax-transient>


  <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">

  <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">

  <link rel="mask-icon" href="https://assets-cdn.github.com/pinned-octocat.svg" color="#000000">
  <link rel="icon" type="image/x-icon" class="js-site-favicon" href="https://assets-cdn.github.com/favicon.ico">

<meta name="theme-color" content="#1e2327">



  <link rel="manifest" href="/manifest.json" crossOrigin="use-credentials">

  </head>

  <body class="logged-out env-production page-blob">
    

  <div class="position-relative js-header-wrapper ">
    <a href="#start-of-content" tabindex="1" class="px-2 py-4 bg-blue text-white show-on-focus js-skip-to-content">Skip to content</a>
    <div id="js-pjax-loader-bar" class="pjax-loader-bar"><div class="progress"></div></div>

    
    
    



        


  <header class="Header header-logged-out  position-relative f4 py-3" role="banner" >
    <div class="container-lg d-flex px-3">
      <div class="d-flex flex-justify-between flex-items-center">
        <a class="header-logo-invertocat my-0" href="https://github.com/" aria-label="Homepage" data-ga-click="(Logged out) Header, go to homepage, icon:logo-wordmark; experiment:site_header_dropdowns; group:control">
          <svg height="32" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg>
        </a>

      </div>

      <div class="HeaderMenu d-flex flex-justify-between flex-auto">
          <nav class="mt-0">
            <ul class="d-flex list-style-none">
                <li class="ml-2">
                  <a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:features; experiment:site_header_dropdowns; group:control" data-selected-links="/features /features/project-management /features/code-review /features/project-management /features/integrations /features" href="/features">
                    Features
</a>                </li>
                <li class="ml-4">
                  <a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:business; experiment:site_header_dropdowns; group:control" data-selected-links="/business /business/security /business/customers /business" href="/business">
                    Business
</a>                </li>

                <li class="ml-4">
                  <a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:explore; experiment:site_header_dropdowns; group:control" data-selected-links="/explore /trending /trending/developers /integrations /integrations/feature/code /integrations/feature/collaborate /integrations/feature/ship showcases showcases_search showcases_landing /explore" href="/explore">
                    Explore
</a>                </li>

                <li class="ml-4">
                      <a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:marketplace; experiment:site_header_dropdowns; group:control" data-selected-links=" /marketplace" href="/marketplace">
                        Marketplace
</a>                </li>
                <li class="ml-4">
                  <a class="js-selected-navigation-item HeaderNavlink px-0 py-2 m-0" data-ga-click="Header, click, Nav menu - item:pricing; experiment:site_header_dropdowns; group:control" data-selected-links="/pricing /pricing/developer /pricing/team /pricing/business-hosted /pricing/business-enterprise /pricing" href="/pricing">
                    Pricing
</a>                </li>
            </ul>
          </nav>

        <div class="d-flex">
            <div class="d-lg-flex flex-items-center mr-3">
              <div class="header-search scoped-search site-scoped-search js-site-search position-relative js-jump-to"
  role="combobox"
  aria-owns="jump-to-results"
  aria-label="Search or jump to"
  aria-haspopup="listbox"
  aria-expanded="false"
>
  <div class="position-relative">
    <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="js-site-search-form" data-scope-type="Repository" data-scope-id="14440270" data-scoped-search-url="/getify/You-Dont-Know-JS/search" data-unscoped-search-url="/search" action="/getify/You-Dont-Know-JS/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
      <label class="form-control header-search-wrapper header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center js-chromeless-input-container">
        <input type="text"
          class="form-control header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
          data-hotkey="s,/"
          name="q"
          value=""
          placeholder="Search"
          data-unscoped-placeholder="Search GitHub"
          data-scoped-placeholder="Search"
          autocapitalize="off"
          aria-autocomplete="list"
          aria-controls="jump-to-results"
          data-jump-to-suggestions-path="/_graphql/GetSuggestedNavigationDestinations#csrf-token=04y3+2ihB6IsQrR6JQC4aETatQVxBeLOa3LrF5BOJ60cL2pbEEZI7x4obcuLqZ7+eQ42YsO64NUut1gST9PzgQ=="
          spellcheck="false"
          autocomplete="off"
          >
          <input type="hidden" class="js-site-search-type-field" name="type" >
            <img src="https://assets-cdn.github.com/images/search-shortcut-hint.svg" alt="" class="mr-2 header-search-key-slash">

            <div class="Box position-absolute overflow-hidden d-none jump-to-suggestions js-jump-to-suggestions-container">
              <ul class="d-none js-jump-to-suggestions-template-container">
                <li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item" role="option">
                  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center p-2 jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open" href="">
                    <div class="jump-to-octicon js-jump-to-octicon mr-2 text-center d-none">
                      <svg height="16" width="16" class="octicon octicon-repo flex-shrink-0 js-jump-to-octicon-repo d-none" title="Repository" aria-label="Repository" viewBox="0 0 12 16" version="1.1" role="img"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"/></svg>
                      <svg height="16" width="16" class="octicon octicon-project flex-shrink-0 js-jump-to-octicon-project d-none" title="Project" aria-label="Project" viewBox="0 0 15 16" version="1.1" role="img"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"/></svg>
                      <svg height="16" width="16" class="octicon octicon-search flex-shrink-0 js-jump-to-octicon-search d-none" title="Search" aria-label="Search" viewBox="0 0 16 16" version="1.1" role="img"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"/></svg>
                    </div>

                    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="" width="28" height="28">

                    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
                    </div>

                    <div class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none js-jump-to-badge-search">
                      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
                        In this repository
                      </span>
                      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
                        All GitHub
                      </span>
                      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
                    </div>

                    <div aria-hidden="true" class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
                      Jump to
                      <span class="d-inline-block ml-1 v-align-middle">↵</span>
                    </div>
                  </a>
                </li>
              </ul>
              <ul class="d-none js-jump-to-no-results-template-container">
                <li class="d-flex flex-justify-center flex-items-center p-3 f5 d-none">
                  <span class="text-gray">No suggested jump to results</span>
                </li>
              </ul>

              <ul id="jump-to-results" role="listbox" class="js-navigation-container jump-to-suggestions-results-container js-jump-to-suggestions-results-container" >
                <li class="d-flex flex-justify-center flex-items-center p-0 f5">
                  <img src="https://assets-cdn.github.com/images/spinners/octocat-spinner-128.gif" alt="Octocat Spinner Icon" class="m-2" width="28">
                </li>
              </ul>
            </div>
      </label>
</form>  </div>
</div>

            </div>

          <span class="d-inline-block">
              <div class="HeaderNavlink px-0 py-2 m-0">
                <a class="text-bold text-white no-underline" href="/login?return_to=%2Fgetify%2FYou-Dont-Know-JS%2Fblob%2Fmaster%2Fthis%2520%2526%2520object%2520prototypes%2Fch6.md" data-ga-click="(Logged out) Header, clicked Sign in, text:sign-in; experiment:site_header_dropdowns; group:control">Sign in</a>
                  <span class="text-gray">or</span>
                  <a class="text-bold text-white no-underline" href="/join?source=header-repo" data-ga-click="(Logged out) Header, clicked Sign up, text:sign-up; experiment:site_header_dropdowns; group:control">Sign up</a>
              </div>
          </span>
        </div>
      </div>
    </div>
  </header>

  </div>

  <div id="start-of-content" class="show-on-focus"></div>

    <div id="js-flash-container">


</div>



  <div role="main" class="application-main ">
        <div itemscope itemtype="http://schema.org/SoftwareSourceCode" class="">
    <div id="js-repo-pjax-container" data-pjax-container >
      







  <div class="pagehead repohead instapaper_ignore readability-menu experiment-repo-nav  ">
    <div class="repohead-details-container clearfix container">

      <ul class="pagehead-actions">
  <li>
      <a href="/login?return_to=%2Fgetify%2FYou-Dont-Know-JS"
    class="btn btn-sm btn-with-count tooltipped tooltipped-s"
    aria-label="You must be signed in to watch a repository" rel="nofollow">
    <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"/></svg>
    Watch
  </a>
  <a class="social-count" href="/getify/You-Dont-Know-JS/watchers"
     aria-label="4796 users are watching this repository">
    4,796
  </a>

  </li>

  <li>
      <a href="/login?return_to=%2Fgetify%2FYou-Dont-Know-JS"
    class="btn btn-sm btn-with-count tooltipped tooltipped-s"
    aria-label="You must be signed in to star a repository" rel="nofollow">
    <svg class="octicon octicon-star v-align-text-bottom" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74L14 6z"/></svg>
    Star
  </a>

    <a class="social-count js-social-count" href="/getify/You-Dont-Know-JS/stargazers"
      aria-label="88853 users starred this repository">
      88,853
    </a>

  </li>

  <li>
      <a href="/login?return_to=%2Fgetify%2FYou-Dont-Know-JS"
        class="btn btn-sm btn-with-count tooltipped tooltipped-s"
        aria-label="You must be signed in to fork a repository" rel="nofollow">
        <svg class="octicon octicon-repo-forked v-align-text-bottom" viewBox="0 0 10 16" version="1.1" width="10" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1a1.993 1.993 0 0 0-1 3.72V6L5 8 3 6V4.72A1.993 1.993 0 0 0 2 1a1.993 1.993 0 0 0-1 3.72V6.5l3 3v1.78A1.993 1.993 0 0 0 5 15a1.993 1.993 0 0 0 1-3.72V9.5l3-3V4.72A1.993 1.993 0 0 0 8 1zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3 10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3-10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"/></svg>
        Fork
      </a>

    <a href="/getify/You-Dont-Know-JS/network/members" class="social-count"
       aria-label="16864 users forked this repository">
      16,864
    </a>
  </li>
</ul>

      <h1 class="public ">
  <svg class="octicon octicon-repo" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"/></svg>
  <span class="author" itemprop="author"><a class="url fn" rel="author" href="/getify">getify</a></span><!--
--><span class="path-divider">/</span><!--
--><strong itemprop="name"><a data-pjax="#js-repo-pjax-container" href="/getify/You-Dont-Know-JS">You-Dont-Know-JS</a></strong>

</h1>

    </div>
    
<nav class="reponav js-repo-nav js-sidenav-container-pjax container"
     itemscope
     itemtype="http://schema.org/BreadcrumbList"
     role="navigation"
     data-pjax="#js-repo-pjax-container">

  <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a class="js-selected-navigation-item selected reponav-item" itemprop="url" data-hotkey="g c" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages /getify/You-Dont-Know-JS" href="/getify/You-Dont-Know-JS">
      <svg class="octicon octicon-code" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z"/></svg>
      <span itemprop="name">Code</span>
      <meta itemprop="position" content="1">
</a>  </span>

    <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a itemprop="url" data-hotkey="g i" class="js-selected-navigation-item reponav-item" data-selected-links="repo_issues repo_labels repo_milestones /getify/You-Dont-Know-JS/issues" href="/getify/You-Dont-Know-JS/issues">
        <svg class="octicon octicon-issue-opened" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg>
        <span itemprop="name">Issues</span>
        <span class="Counter">110</span>
        <meta itemprop="position" content="2">
</a>    </span>

  <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a data-hotkey="g p" itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_pulls checks /getify/You-Dont-Know-JS/pulls" href="/getify/You-Dont-Know-JS/pulls">
      <svg class="octicon octicon-git-pull-request" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"/></svg>
      <span itemprop="name">Pull requests</span>
      <span class="Counter">75</span>
      <meta itemprop="position" content="3">
</a>  </span>

    <a data-hotkey="g b" class="js-selected-navigation-item reponav-item" data-selected-links="repo_projects new_repo_project repo_project /getify/You-Dont-Know-JS/projects" href="/getify/You-Dont-Know-JS/projects">
      <svg class="octicon octicon-project" viewBox="0 0 15 16" version="1.1" width="15" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"/></svg>
      Projects
      <span class="Counter" >1</span>
</a>


    <a class="js-selected-navigation-item reponav-item" data-hotkey="g w" data-selected-links="repo_wiki /getify/You-Dont-Know-JS/wiki" href="/getify/You-Dont-Know-JS/wiki">
      <svg class="octicon octicon-book" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M3 5h4v1H3V5zm0 3h4V7H3v1zm0 2h4V9H3v1zm11-5h-4v1h4V5zm0 2h-4v1h4V7zm0 2h-4v1h4V9zm2-6v9c0 .55-.45 1-1 1H9.5l-1 1-1-1H2c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h5.5l1 1 1-1H15c.55 0 1 .45 1 1zm-8 .5L7.5 3H2v9h6V3.5zm7-.5H9.5l-.5.5V12h6V3z"/></svg>
      Wiki
</a>
  <a class="js-selected-navigation-item reponav-item" data-selected-links="repo_graphs repo_contributors dependency_graph pulse alerts /getify/You-Dont-Know-JS/pulse" href="/getify/You-Dont-Know-JS/pulse">
    <svg class="octicon octicon-graph" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M16 14v1H0V0h1v14h15zM5 13H3V8h2v5zm4 0H7V3h2v10zm4 0h-2V6h2v7z"/></svg>
    Insights
</a>

</nav>


  </div>

<div class="container new-discussion-timeline experiment-repo-nav  ">
  <div class="repository-content ">

    
  <a class="d-none js-permalink-shortcut" data-hotkey="y" href="/getify/You-Dont-Know-JS/blob/0cc17c53ff772e20dfd6a7072c965df2486116e8/this%20%26%20object%20prototypes/ch6.md">Permalink</a>

  <!-- blob contrib key: blob_contributors:v21:c2a45aaf9a2be1c2c103a8c3c22a4956 -->

      <div class="signup-prompt-bg rounded-1">
      <div class="signup-prompt p-4 text-center mb-4 rounded-1">
        <div class="position-relative">
          <!-- '"` --><!-- </textarea></xmp> --></option></form><form action="/site/dismiss_signup_prompt" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="MELq+Nw80S2voiWzkQezzrE9pxNFtm9u4knimZT2AOsIN8iNoTK5lGy4Y4Z++ofsA7LK9wa1ogfv/sPXMpZ/3Q==" />
            <button type="submit" class="position-absolute top-0 right-0 btn-link link-gray" data-ga-click="(Logged out) Sign up prompt, clicked Dismiss, text:dismiss">
              Dismiss
            </button>
</form>          <h3 class="pt-2">Join GitHub today</h3>
          <p class="col-6 mx-auto">GitHub is home to over 28 million developers working together to host and review code, manage projects, and build software together.</p>
          <a class="btn btn-primary" href="/join?source=prompt-blob-show" data-ga-click="(Logged out) Sign up prompt, clicked Sign up, text:sign-up">Sign up</a>
        </div>
      </div>
    </div>


  <div class="file-navigation">
    
<div class="select-menu branch-select-menu js-menu-container js-select-menu float-left">
  <button class=" btn btn-sm select-menu-button js-menu-target css-truncate" data-hotkey="w"
    
    type="button" aria-label="Switch branches or tags" aria-expanded="false" aria-haspopup="true">
      <i>Branch:</i>
      <span class="js-select-button css-truncate-target">master</span>
  </button>

  <div class="select-menu-modal-holder js-menu-content js-navigation-container" data-pjax>

    <div class="select-menu-modal">
      <div class="select-menu-header">
        <svg class="octicon octicon-x js-menu-close" role="img" aria-label="Close" viewBox="0 0 12 16" version="1.1" width="12" height="16"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"/></svg>
        <span class="select-menu-title">Switch branches/tags</span>
      </div>

      <div class="select-menu-filters">
        <div class="select-menu-text-filter">
          <input type="text" aria-label="Filter branches/tags" id="context-commitish-filter-field" class="form-control js-filterable-field js-navigation-enable" placeholder="Filter branches/tags">
        </div>
        <div class="select-menu-tabs">
          <ul>
            <li class="select-menu-tab">
              <a href="#" data-tab-filter="branches" data-filter-placeholder="Filter branches/tags" class="js-select-menu-tab" role="tab">Branches</a>
            </li>
            <li class="select-menu-tab">
              <a href="#" data-tab-filter="tags" data-filter-placeholder="Find a tag…" class="js-select-menu-tab" role="tab">Tags</a>
            </li>
          </ul>
        </div>
      </div>

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="branches" role="menu">

        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


            <a class="select-menu-item js-navigation-item js-navigation-open "
               href="/getify/You-Dont-Know-JS/blob/1ed-zh-CN/this%20&amp;%20object%20prototypes/ch6.md"
               data-name="1ed-zh-CN"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                1ed-zh-CN
              </span>
            </a>
            <a class="select-menu-item js-navigation-item js-navigation-open selected"
               href="/getify/You-Dont-Know-JS/blob/master/this%20&amp;%20object%20prototypes/ch6.md"
               data-name="master"
               data-skip-pjax="true"
               rel="nofollow">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <span class="select-menu-item-text css-truncate-target js-select-menu-filter-text">
                master
              </span>
            </a>
        </div>

          <div class="select-menu-no-results">Nothing to show</div>
      </div>

      <div class="select-menu-list select-menu-tab-bucket js-select-menu-tab-bucket" data-tab-filter="tags">
        <div data-filterable-for="context-commitish-filter-field" data-filterable-type="substring">


        </div>

        <div class="select-menu-no-results">Nothing to show</div>
      </div>

    </div>
  </div>
</div>

    <div class="BtnGroup float-right">
      <a href="/getify/You-Dont-Know-JS/find/master"
            class="js-pjax-capture-input btn btn-sm BtnGroup-item"
            data-pjax
            data-hotkey="t">
        Find file
      </a>
      <clipboard-copy for="blob-path" class="btn btn-sm BtnGroup-item">
        Copy path
      </clipboard-copy>
    </div>
    <div id="blob-path" class="breadcrumb">
      <span class="repo-root js-repo-root"><span class="js-path-segment"><a data-pjax="true" href="/getify/You-Dont-Know-JS"><span>You-Dont-Know-JS</span></a></span></span><span class="separator">/</span><span class="js-path-segment"><a data-pjax="true" href="/getify/You-Dont-Know-JS/tree/master/this%20%26%20object%20prototypes"><span>this &amp; object prototypes</span></a></span><span class="separator">/</span><strong class="final-path">ch6.md</strong>
    </div>
  </div>


  
  <div class="commit-tease">
      <span class="float-right">
        <a class="commit-tease-sha" href="/getify/You-Dont-Know-JS/commit/6e77b02f9d5cf70ad381a3257b043195389fcbef" data-pjax>
          6e77b02
        </a>
        <relative-time datetime="2018-05-17T03:22:24Z">May 16, 2018</relative-time>
      </span>
      <div>
        <a rel="author" data-skip-pjax="true" data-hovercard-user-id="150330" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/getify"><img class="avatar" src="https://avatars3.githubusercontent.com/u/150330?s=40&amp;v=4" width="20" height="20" alt="@getify" /></a>
        <a class="user-mention" rel="author" data-hovercard-user-id="150330" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/getify">getify</a>
          <a data-pjax="true" title="removing extraneous space" class="message" href="/getify/You-Dont-Know-JS/commit/6e77b02f9d5cf70ad381a3257b043195389fcbef">removing extraneous space</a>
      </div>

    <div class="commit-tease-contributors">
      
<details class="details-reset details-overlay details-overlay-dark lh-default text-gray-dark float-left mr-2" id="blob_contributors_box">
  <summary class="btn-link" aria-haspopup="dialog"  >
    
    <span><strong>11</strong> contributors</span>
  </summary>
  <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast " aria-label="Users who have contributed to this file">
    <div class="Box-header">
      <button class="Box-btn-octicon btn-octicon float-right" type="button" aria-label="Close dialog" data-close-dialog>
        <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"/></svg>
      </button>
      <h3 class="Box-title">Users who have contributed to this file</h3>
    </div>
    
        <ul class="list-style-none overflow-auto">
            <li class="Box-row">
              <a class="link-gray-dark no-underline" href="/getify">
                <img class="avatar mr-2" alt="" src="https://avatars3.githubusercontent.com/u/150330?s=40&amp;v=4" width="20" height="20" />
                getify
</a>            </li>
            <li class="Box-row">
              <a class="link-gray-dark no-underline" href="/harpreetkhalsagtbit">
                <img class="avatar mr-2" alt="" src="https://avatars3.githubusercontent.com/u/2958292?s=40&amp;v=4" width="20" height="20" />
                harpreetkhalsagtbit
</a>            </li>
            <li class="Box-row">
              <a class="link-gray-dark no-underline" href="/4thana">
                <img class="avatar mr-2" alt="" src="https://avatars2.githubusercontent.com/u/8932386?s=40&amp;v=4" width="20" height="20" />
                4thana
</a>            </li>
            <li class="Box-row">
              <a class="link-gray-dark no-underline" href="/whitepear">
                <img class="avatar mr-2" alt="" src="https://avatars3.githubusercontent.com/u/18552013?s=40&amp;v=4" width="20" height="20" />
                whitepear
</a>            </li>
            <li class="Box-row">
              <a class="link-gray-dark no-underline" href="/wewea">
                <img class="avatar mr-2" alt="" src="https://avatars2.githubusercontent.com/u/6269927?s=40&amp;v=4" width="20" height="20" />
                wewea
</a>            </li>
            <li class="Box-row">
              <a class="link-gray-dark no-underline" href="/lyle">
                <img class="avatar mr-2" alt="" src="https://avatars2.githubusercontent.com/u/21094?s=40&amp;v=4" width="20" height="20" />
                lyle
</a>            </li>
            <li class="Box-row">
              <a class="link-gray-dark no-underline" href="/lw7360">
                <img class="avatar mr-2" alt="" src="https://avatars1.githubusercontent.com/u/1806683?s=40&amp;v=4" width="20" height="20" />
                lw7360
</a>            </li>
            <li class="Box-row">
              <a class="link-gray-dark no-underline" href="/MehdiRaash">
                <img class="avatar mr-2" alt="" src="https://avatars0.githubusercontent.com/u/6185507?s=40&amp;v=4" width="20" height="20" />
                MehdiRaash
</a>            </li>
            <li class="Box-row">
              <a class="link-gray-dark no-underline" href="/machineloop">
                <img class="avatar mr-2" alt="" src="https://avatars3.githubusercontent.com/u/3682072?s=40&amp;v=4" width="20" height="20" />
                machineloop
</a>            </li>
            <li class="Box-row">
              <a class="link-gray-dark no-underline" href="/elkebirmed">
                <img class="avatar mr-2" alt="" src="https://avatars0.githubusercontent.com/u/3056412?s=40&amp;v=4" width="20" height="20" />
                elkebirmed
</a>            </li>
            <li class="Box-row">
              <a class="link-gray-dark no-underline" href="/severyanov">
                <img class="avatar mr-2" alt="" src="https://avatars0.githubusercontent.com/u/2435551?s=40&amp;v=4" width="20" height="20" />
                severyanov
</a>            </li>
        </ul>

  </details-dialog>
</details>
          <a class="avatar-link" data-hovercard-user-id="150330" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/getify/You-Dont-Know-JS/commits/master/this%20%26%20object%20prototypes/ch6.md?author=getify">
      <img class="avatar" src="https://avatars3.githubusercontent.com/u/150330?s=40&amp;v=4" width="20" height="20" alt="@getify" /> 
</a>    <a class="avatar-link" data-hovercard-user-id="2958292" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/getify/You-Dont-Know-JS/commits/master/this%20%26%20object%20prototypes/ch6.md?author=harpreetkhalsagtbit">
      <img class="avatar" src="https://avatars3.githubusercontent.com/u/2958292?s=40&amp;v=4" width="20" height="20" alt="@harpreetkhalsagtbit" /> 
</a>    <a class="avatar-link" data-hovercard-user-id="8932386" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/getify/You-Dont-Know-JS/commits/master/this%20%26%20object%20prototypes/ch6.md?author=4thana">
      <img class="avatar" src="https://avatars2.githubusercontent.com/u/8932386?s=40&amp;v=4" width="20" height="20" alt="@4thana" /> 
</a>    <a class="avatar-link" data-hovercard-user-id="18552013" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/getify/You-Dont-Know-JS/commits/master/this%20%26%20object%20prototypes/ch6.md?author=whitepear">
      <img class="avatar" src="https://avatars3.githubusercontent.com/u/18552013?s=40&amp;v=4" width="20" height="20" alt="@whitepear" /> 
</a>    <a class="avatar-link" data-hovercard-user-id="6269927" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/getify/You-Dont-Know-JS/commits/master/this%20%26%20object%20prototypes/ch6.md?author=wewea">
      <img class="avatar" src="https://avatars2.githubusercontent.com/u/6269927?s=40&amp;v=4" width="20" height="20" alt="@wewea" /> 
</a>    <a class="avatar-link" data-hovercard-user-id="21094" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/getify/You-Dont-Know-JS/commits/master/this%20%26%20object%20prototypes/ch6.md?author=lyle">
      <img class="avatar" src="https://avatars2.githubusercontent.com/u/21094?s=40&amp;v=4" width="20" height="20" alt="@lyle" /> 
</a>    <a class="avatar-link" data-hovercard-user-id="1806683" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/getify/You-Dont-Know-JS/commits/master/this%20%26%20object%20prototypes/ch6.md?author=lw7360">
      <img class="avatar" src="https://avatars1.githubusercontent.com/u/1806683?s=40&amp;v=4" width="20" height="20" alt="@lw7360" /> 
</a>    <a class="avatar-link" data-hovercard-user-id="6185507" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/getify/You-Dont-Know-JS/commits/master/this%20%26%20object%20prototypes/ch6.md?author=MehdiRaash">
      <img class="avatar" src="https://avatars0.githubusercontent.com/u/6185507?s=40&amp;v=4" width="20" height="20" alt="@MehdiRaash" /> 
</a>    <a class="avatar-link" data-hovercard-user-id="3682072" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/getify/You-Dont-Know-JS/commits/master/this%20%26%20object%20prototypes/ch6.md?author=machineloop">
      <img class="avatar" src="https://avatars3.githubusercontent.com/u/3682072?s=40&amp;v=4" width="20" height="20" alt="@machineloop" /> 
</a>    <a class="avatar-link" data-hovercard-user-id="3056412" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/getify/You-Dont-Know-JS/commits/master/this%20%26%20object%20prototypes/ch6.md?author=elkebirmed">
      <img class="avatar" src="https://avatars0.githubusercontent.com/u/3056412?s=40&amp;v=4" width="20" height="20" alt="@elkebirmed" /> 
</a>    <a class="avatar-link" data-hovercard-user-id="2435551" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/getify/You-Dont-Know-JS/commits/master/this%20%26%20object%20prototypes/ch6.md?author=severyanov">
      <img class="avatar" src="https://avatars0.githubusercontent.com/u/2435551?s=40&amp;v=4" width="20" height="20" alt="@severyanov" /> 
</a>

    </div>
  </div>



  <div class="file">
    <div class="file-header">
  <div class="file-actions">

    <div class="BtnGroup">
      <a id="raw-url" class="btn btn-sm BtnGroup-item" href="/getify/You-Dont-Know-JS/raw/master/this%20%26%20object%20prototypes/ch6.md">Raw</a>
        <a class="btn btn-sm js-update-url-with-hash BtnGroup-item" data-hotkey="b" href="/getify/You-Dont-Know-JS/blame/master/this%20%26%20object%20prototypes/ch6.md">Blame</a>
      <a rel="nofollow" class="btn btn-sm BtnGroup-item" href="/getify/You-Dont-Know-JS/commits/master/this%20%26%20object%20prototypes/ch6.md">History</a>
    </div>


        <button type="button" class="btn-octicon disabled tooltipped tooltipped-nw"
          aria-label="You must be signed in to make or propose changes">
          <svg class="octicon octicon-pencil" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M0 12v3h3l8-8-3-3-8 8zm3 2H1v-2h1v1h1v1zm10.3-9.3L12 6 9 3l1.3-1.3a.996.996 0 0 1 1.41 0l1.59 1.59c.39.39.39 1.02 0 1.41z"/></svg>
        </button>
        <button type="button" class="btn-octicon btn-octicon-danger disabled tooltipped tooltipped-nw"
          aria-label="You must be signed in to make or propose changes">
          <svg class="octicon octicon-trashcan" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M11 2H9c0-.55-.45-1-1-1H5c-.55 0-1 .45-1 1H2c-.55 0-1 .45-1 1v1c0 .55.45 1 1 1v9c0 .55.45 1 1 1h7c.55 0 1-.45 1-1V5c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm-1 12H3V5h1v8h1V5h1v8h1V5h1v8h1V5h1v9zm1-10H2V3h9v1z"/></svg>
        </button>
  </div>

  <div class="file-info">
      918 lines (661 sloc)
      <span class="file-info-divider"></span>
    46.9 KB
  </div>
</div>

    
  <div id="readme" class="readme blob instapaper_body">
    <article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-you-dont-know-js-this--object-prototypes" class="anchor" aria-hidden="true" href="#you-dont-know-js-this--object-prototypes"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>You Don't Know JS: <em>this</em> &amp; Object Prototypes</h1>
<h1><a id="user-content-chapter-6-behavior-delegation" class="anchor" aria-hidden="true" href="#chapter-6-behavior-delegation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Chapter 6: Behavior Delegation</h1>
<p>In Chapter 5, we addressed the <code>[[Prototype]]</code> mechanism  in detail, and <em>why</em> it's confusing and inappropriate (despite countless attempts for nearly two decades) to describe it as "class" or "inheritance". We trudged through not only the fairly verbose syntax (<code>.prototype</code> littering the code), but the various gotchas (like surprising <code>.constructor</code> resolution or ugly pseudo-polymorphic syntax). We explored variations of the "mixin" approach, which many people use to attempt to smooth over such rough areas.</p>
<p>It's a common reaction at this point to wonder why it has to be so complex to do something seemingly so simple. Now that we've pulled back the curtain and seen just how dirty it all gets, it's not a surprise that most JS developers never dive this deep, and instead relegate such mess to a "class" library to handle it for them.</p>
<p>I hope by now you're not content to just gloss over and leave such details to a "black box" library. Let's now dig into how we <em>could and should be</em> thinking about the object <code>[[Prototype]]</code> mechanism in JS, in a <strong>much simpler and more straightforward way</strong> than the confusion of classes.</p>
<p>As a brief review of our conclusions from Chapter 5, the <code>[[Prototype]]</code> mechanism is an internal link that exists on one object which references another object.</p>
<p>This linkage is exercised when a property/method reference is made against the first object, and no such property/method exists. In that case, the <code>[[Prototype]]</code> linkage tells the engine to look for the property/method on the linked-to object. In turn, if that object cannot fulfill the look-up, its <code>[[Prototype]]</code> is followed, and so on. This series of links between objects forms what is called the "prototype chain".</p>
<p>In other words, the actual mechanism, the essence of what's important to the functionality we can leverage in JavaScript, is <strong>all about objects being linked to other objects.</strong></p>
<p>That single observation is fundamental and critical to understanding the motivations and approaches for the rest of this chapter!</p>
<h2><a id="user-content-towards-delegation-oriented-design" class="anchor" aria-hidden="true" href="#towards-delegation-oriented-design"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Towards Delegation-Oriented Design</h2>
<p>To properly focus our thoughts on how to use <code>[[Prototype]]</code> in the most straightforward way, we must recognize that it represents a fundamentally different design pattern from classes (see Chapter 4).</p>
<p><strong>Note:</strong> <em>Some</em> principles of class-oriented design are still very valid, so don't toss out everything you know (just most of it!). For example, <em>encapsulation</em> is quite powerful, and is compatible (though not as common) with delegation.</p>
<p>We need to try to change our thinking from the class/inheritance design pattern to the behavior delegation design pattern. If you have done most or all of your programming in your education/career thinking in classes, this may be uncomfortable or feel unnatural. You may need to try this mental exercise quite a few times to get the hang of this very different way of thinking.</p>
<p>I'm going to walk you through some theoretical exercises first, then we'll look side-by-side at a more concrete example to give you practical context for your own code.</p>
<h3><a id="user-content-class-theory" class="anchor" aria-hidden="true" href="#class-theory"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Class Theory</h3>
<p>Let's say we have several similar tasks ("XYZ", "ABC", etc) that we need to model in our software.</p>
<p>With classes, the way you design the scenario is: define a general parent (base) class like <code>Task</code>, defining shared behavior for all the "alike" tasks. Then, you define child classes <code>XYZ</code> and <code>ABC</code>, both of which inherit from <code>Task</code>, and each of which adds specialized behavior to handle their respective tasks.</p>
<p><strong>Importantly,</strong> the class design pattern will encourage you that to get the most out of inheritance, you will want to employ method overriding (and polymorphism), where you override the definition of some general <code>Task</code> method in your <code>XYZ</code> task, perhaps even making use of <code>super</code> to call to the base version of that method while adding more behavior to it. <strong>You'll likely find quite a few places</strong> where you can "abstract" out general behavior to the parent class and specialize (override) it in your child classes.</p>
<p>Here's some loose pseudo-code for that scenario:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">class</span> <span class="pl-en">Task</span> {
	id;

	<span class="pl-c"><span class="pl-c">//</span> constructor `Task()`</span>
	<span class="pl-en">Task</span>(<span class="pl-c1">ID</span>) { id <span class="pl-k">=</span> <span class="pl-c1">ID</span>; }
	<span class="pl-en">outputTask</span>() { <span class="pl-en">output</span>( id ); }
}

<span class="pl-k">class</span> <span class="pl-en">XYZ</span> inherits Task {
	label;

	<span class="pl-c"><span class="pl-c">//</span> constructor `XYZ()`</span>
	<span class="pl-en">XYZ</span>(<span class="pl-c1">ID</span>,<span class="pl-smi">Label</span>) { <span class="pl-c1">super</span>( <span class="pl-c1">ID</span> ); label <span class="pl-k">=</span> Label; }
	<span class="pl-en">outputTask</span>() { <span class="pl-c1">super</span>(); <span class="pl-en">output</span>( label ); }
}

<span class="pl-k">class</span> <span class="pl-en">ABC</span> inherits Task {
	<span class="pl-c"><span class="pl-c">//</span> ...</span>
}</pre></div>
<p>Now, you can instantiate one or more <strong>copies</strong> of the <code>XYZ</code> child class, and use those instance(s) to perform task "XYZ". These instances have <strong>copies both</strong> of the general <code>Task</code> defined behavior as well as the specific <code>XYZ</code> defined behavior. Likewise, instances of the <code>ABC</code> class would have copies of the <code>Task</code> behavior and the specific <code>ABC</code> behavior. After construction, you will generally only interact with these instances (and not the classes), as the instances each have copies of all the behavior you need to do the intended task.</p>
<h3><a id="user-content-delegation-theory" class="anchor" aria-hidden="true" href="#delegation-theory"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Delegation Theory</h3>
<p>But now let's try to think about the same problem domain, but using <em>behavior delegation</em> instead of <em>classes</em>.</p>
<p>You will first define an <strong>object</strong> (not a class, nor a <code>function</code> as most JS'rs would lead you to believe) called <code>Task</code>, and it will have concrete behavior on it that includes utility methods that various tasks can use (read: <em>delegate to</em>!). Then, for each task ("XYZ", "ABC"), you define an <strong>object</strong> to hold that task-specific data/behavior. You <strong>link</strong> your task-specific object(s) to the <code>Task</code> utility object, allowing them to delegate to it when they need to.</p>
<p>Basically, you think about performing task "XYZ" as needing behaviors from two sibling/peer objects (<code>XYZ</code> and <code>Task</code>) to accomplish it. But rather than needing to compose them together, via class copies, we can keep them in their separate objects, and we can allow <code>XYZ</code> object to <strong>delegate to</strong> <code>Task</code> when needed.</p>
<p>Here's some simple code to suggest how you accomplish that:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> Task <span class="pl-k">=</span> {
	<span class="pl-en">setID</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-c1">ID</span>) { <span class="pl-c1">this</span>.<span class="pl-c1">id</span> <span class="pl-k">=</span> <span class="pl-c1">ID</span>; },
	<span class="pl-en">outputID</span><span class="pl-k">:</span> <span class="pl-k">function</span>() { <span class="pl-en">console</span>.<span class="pl-c1">log</span>( <span class="pl-c1">this</span>.<span class="pl-c1">id</span> ); }
};

<span class="pl-c"><span class="pl-c">//</span> make `XYZ` delegate to `Task`</span>
<span class="pl-k">var</span> <span class="pl-c1">XYZ</span> <span class="pl-k">=</span> <span class="pl-c1">Object</span>.<span class="pl-en">create</span>( Task );

<span class="pl-c1">XYZ</span>.<span class="pl-en">prepareTask</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-c1">ID</span>,<span class="pl-smi">Label</span>) {
	<span class="pl-c1">this</span>.<span class="pl-en">setID</span>( <span class="pl-c1">ID</span> );
	<span class="pl-c1">this</span>.<span class="pl-c1">label</span> <span class="pl-k">=</span> Label;
};

<span class="pl-c1">XYZ</span>.<span class="pl-en">outputTaskDetails</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
	<span class="pl-c1">this</span>.<span class="pl-en">outputID</span>();
	<span class="pl-en">console</span>.<span class="pl-c1">log</span>( <span class="pl-c1">this</span>.<span class="pl-c1">label</span> );
};

<span class="pl-c"><span class="pl-c">//</span> ABC = Object.create( Task );</span>
<span class="pl-c"><span class="pl-c">//</span> ABC ... = ...</span></pre></div>
<p>In this code, <code>Task</code> and <code>XYZ</code> are not classes (or functions), they're <strong>just objects</strong>. <code>XYZ</code> is set up via <code>Object.create(..)</code> to <code>[[Prototype]]</code> delegate to the <code>Task</code> object (see Chapter 5).</p>
<p>As compared to class-orientation (aka, OO -- object-oriented), I call this style of code <strong>"OLOO"</strong> (objects-linked-to-other-objects). All we <em>really</em> care about is that the <code>XYZ</code> object delegates to the <code>Task</code> object (as does the <code>ABC</code> object).</p>
<p>In JavaScript, the <code>[[Prototype]]</code> mechanism links <strong>objects</strong> to other <strong>objects</strong>. There are no abstract mechanisms like "classes", no matter how much you try to convince yourself otherwise. It's like paddling a canoe upstream: you <em>can</em> do it, but you're <em>choosing</em> to go against the natural current, so it's obviously <strong>going to be harder to get where you're going.</strong></p>
<p>Some other differences to note with <strong>OLOO style code</strong>:</p>
<ol>
<li>
<p>Both <code>id</code> and <code>label</code> data members from the previous class example are data properties directly on <code>XYZ</code> (neither is on <code>Task</code>). In general, with <code>[[Prototype]]</code> delegation involved, <strong>you want state to be on the delegators</strong> (<code>XYZ</code>, <code>ABC</code>), not on the delegate (<code>Task</code>).</p>
</li>
<li>
<p>With the class design pattern, we intentionally named <code>outputTask</code> the same on both parent (<code>Task</code>) and child (<code>XYZ</code>), so that we could take advantage of overriding (polymorphism). In behavior delegation, we do the opposite: <strong>we avoid if at all possible naming things the same</strong> at different levels of the <code>[[Prototype]]</code> chain (called shadowing -- see Chapter 5), because having those name collisions creates awkward/brittle syntax to disambiguate references (see Chapter 4), and we want to avoid that if we can.</p>
<p>This design pattern calls for less of general method names which are prone to overriding and instead more of descriptive method names, <em>specific</em> to the type of behavior each object is doing. <strong>This can actually create easier to understand/maintain code</strong>, because the names of methods (not only at definition location but strewn throughout other code) are more obvious (self documenting).</p>
</li>
<li>
<p><code>this.setID(ID);</code> inside of a method on the <code>XYZ</code> object first looks on <code>XYZ</code> for <code>setID(..)</code>, but since it doesn't find a method of that name on <code>XYZ</code>, <code>[[Prototype]]</code> <em>delegation</em> means it can follow the link to <code>Task</code> to look for <code>setID(..)</code>, which it of course finds. Moreover, because of implicit call-site <code>this</code> binding rules (see Chapter 2), when <code>setID(..)</code> runs, even though the method was found on <code>Task</code>, the <code>this</code> binding for that function call is <code>XYZ</code> exactly as we'd expect and want. We see the same thing with <code>this.outputID()</code> later in the code listing.</p>
<p>In other words, the general utility methods that exist on <code>Task</code> are available to us while interacting with <code>XYZ</code>, because <code>XYZ</code> can delegate to <code>Task</code>.</p>
</li>
</ol>
<p><strong>Behavior Delegation</strong> means: let some object (<code>XYZ</code>) provide a delegation (to <code>Task</code>) for property or method references if not found on the object (<code>XYZ</code>).</p>
<p>This is an <em>extremely powerful</em> design pattern, very distinct from the idea of parent and child classes, inheritance, polymorphism, etc. Rather than organizing the objects in your mind vertically, with Parents flowing down to Children, think of objects side-by-side, as peers, with any direction of delegation links between the objects as necessary.</p>
<p><strong>Note:</strong> Delegation is more properly used as an internal implementation detail rather than exposed directly in the API design. In the above example, we don't necessarily <em>intend</em> with our API design for developers to call <code>XYZ.setID()</code> (though we can, of course!). We sorta <em>hide</em> the delegation as an internal detail of our API, where <code>XYZ.prepareTask(..)</code> delegates to <code>Task.setID(..)</code>. See the "Links As Fallbacks?" discussion in Chapter 5 for more detail.</p>
<h4><a id="user-content-mutual-delegation-disallowed" class="anchor" aria-hidden="true" href="#mutual-delegation-disallowed"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mutual Delegation (Disallowed)</h4>
<p>You cannot create a <em>cycle</em> where two or more objects are mutually delegated (bi-directionally) to each other. If you make <code>B</code> linked to <code>A</code>, and then try to link <code>A</code> to <code>B</code>, you will get an error.</p>
<p>It's a shame (not terribly surprising, but mildly annoying) that this is disallowed. If you made a reference to a property/method which didn't exist in either place, you'd have an infinite recursion on the <code>[[Prototype]]</code> loop. But if all references were strictly present, then <code>B</code> could delegate to <code>A</code>, and vice versa, and it <em>could</em> work. This would mean you could use either object to delegate to the other, for various tasks. There are a few niche use-cases where this might be helpful.</p>
<p>But it's disallowed because engine implementors have observed that it's more performant to check for (and reject!) the infinite circular reference once at set-time rather than needing to have the performance hit of that guard check every time you look-up a property on an object.</p>
<h4><a id="user-content-debugged" class="anchor" aria-hidden="true" href="#debugged"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Debugged</h4>
<p>We'll briefly cover a subtle detail that can be confusing to developers. In general, the JS specification does not control how browser developer tools should represent specific values/structures to a developer, so each browser/engine is free to interpret such things as they see fit. As such, browsers/tools <em>don't always agree</em>. Specifically, the behavior we will now examine is currently observed only in Chrome's Developer Tools.</p>
<p>Consider this traditional "class constructor" style JS code, as it would appear in the <em>console</em> of Chrome Developer Tools:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">function</span> <span class="pl-en">Foo</span>() {}

<span class="pl-k">var</span> a1 <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Foo</span>();

a1; <span class="pl-c"><span class="pl-c">//</span> Foo {}</span></pre></div>
<p>Let's look at the last line of that snippet: the output of evaluating the <code>a1</code> expression, which prints <code>Foo {}</code>. If you try this same code in Firefox, you will likely see <code>Object {}</code>. Why the difference? What do these outputs mean?</p>
<p>Chrome is essentially saying "{} is an empty object that was constructed by a function with name 'Foo'". Firefox is saying "{} is an empty object of general construction from Object". The subtle difference is that Chrome is actively tracking, as an <em>internal property</em>, the name of the actual function that did the construction, whereas other browsers don't track that additional information.</p>
<p>It would be tempting to attempt to explain this with JavaScript mechanisms:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">function</span> <span class="pl-en">Foo</span>() {}

<span class="pl-k">var</span> a1 <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Foo</span>();

<span class="pl-smi">a1</span>.<span class="pl-c1">constructor</span>; <span class="pl-c"><span class="pl-c">//</span> Foo(){}</span>
<span class="pl-smi">a1</span>.<span class="pl-c1">constructor</span>.<span class="pl-c1">name</span>; <span class="pl-c"><span class="pl-c">//</span> "Foo"</span></pre></div>
<p>So, is that how Chrome is outputting "Foo", by simply examining the object's <code>.constructor.name</code>? Confusingly, the answer is both "yes" and "no".</p>
<p>Consider this code:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">function</span> <span class="pl-en">Foo</span>() {}

<span class="pl-k">var</span> a1 <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Foo</span>();

<span class="pl-smi">Foo</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">constructor</span> <span class="pl-k">=</span> <span class="pl-k">function</span> <span class="pl-en">Gotcha</span>(){};

<span class="pl-smi">a1</span>.<span class="pl-c1">constructor</span>; <span class="pl-c"><span class="pl-c">//</span> Gotcha(){}</span>
<span class="pl-smi">a1</span>.<span class="pl-c1">constructor</span>.<span class="pl-c1">name</span>; <span class="pl-c"><span class="pl-c">//</span> "Gotcha"</span>

a1; <span class="pl-c"><span class="pl-c">//</span> Foo {}</span></pre></div>
<p>Even though we change <code>a1.constructor.name</code> to legitimately be something else ("Gotcha"), Chrome's console still uses the "Foo" name.</p>
<p>So, it would appear the answer to previous question (does it use <code>.constructor.name</code>?) is <strong>no</strong>, it must track it somewhere else, internally.</p>
<p>But, Not so fast! Let's see how this kind of behavior works with OLOO-style code:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> Foo <span class="pl-k">=</span> {};

<span class="pl-k">var</span> a1 <span class="pl-k">=</span> <span class="pl-c1">Object</span>.<span class="pl-en">create</span>( Foo );

a1; <span class="pl-c"><span class="pl-c">//</span> Object {}</span>

<span class="pl-c1">Object</span>.<span class="pl-en">defineProperty</span>( Foo, <span class="pl-s"><span class="pl-pds">"</span>constructor<span class="pl-pds">"</span></span>, {
	enumerable<span class="pl-k">:</span> <span class="pl-c1">false</span>,
	<span class="pl-en">value</span><span class="pl-k">:</span> <span class="pl-k">function</span> <span class="pl-en">Gotcha</span>(){}
});

a1; <span class="pl-c"><span class="pl-c">//</span> Gotcha {}</span></pre></div>
<p>Ah-ha! <strong>Gotcha!</strong> Here, Chrome's console <strong>did</strong> find and use the <code>.constructor.name</code>. Actually, while writing this book, this exact behavior was identified as a bug in Chrome, and by the time you're reading this, it may have already been fixed. So you may instead have seen the corrected <code>a1; // Object {}</code>.</p>
<p>Aside from that bug, the internal tracking (apparently only for debug output purposes) of the "constructor name" that Chrome does (shown in the earlier snippets) is an intentional Chrome-only extension of behavior beyond what the JS specification calls for.</p>
<p>If you don't use a "constructor" to make your objects, as we've discouraged with OLOO-style code here in this chapter, then you'll get objects that Chrome does <em>not</em> track an internal "constructor name" for, and such objects will correctly only be outputted as "Object {}", meaning "object generated from Object() construction".</p>
<p><strong>Don't think</strong> this represents a drawback of OLOO-style coding. When you code with OLOO and behavior delegation as your design pattern, <em>who</em> "constructed" (that is, <em>which function</em> was called with <code>new</code>?) some object is an irrelevant detail. Chrome's specific internal "constructor name" tracking is really only useful if you're fully embracing "class-style" coding, but is moot if you're instead embracing OLOO delegation.</p>
<h3><a id="user-content-mental-models-compared" class="anchor" aria-hidden="true" href="#mental-models-compared"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mental Models Compared</h3>
<p>Now that you can see a difference between "class" and "delegation" design patterns, at least theoretically, let's see the implications these design patterns have on the mental models we use to reason about our code.</p>
<p>We'll examine some more theoretical ("Foo", "Bar") code, and compare both ways (OO vs. OLOO) of implementing the code. The first snippet uses the classical ("prototypal") OO style:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">function</span> <span class="pl-en">Foo</span>(<span class="pl-smi">who</span>) {
	<span class="pl-c1">this</span>.<span class="pl-smi">me</span> <span class="pl-k">=</span> who;
}
<span class="pl-smi">Foo</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">identify</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
	<span class="pl-k">return</span> <span class="pl-s"><span class="pl-pds">"</span>I am <span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-c1">this</span>.<span class="pl-smi">me</span>;
};

<span class="pl-k">function</span> <span class="pl-en">Bar</span>(<span class="pl-smi">who</span>) {
	<span class="pl-smi">Foo</span>.<span class="pl-c1">call</span>( <span class="pl-c1">this</span>, who );
}
<span class="pl-smi">Bar</span>.<span class="pl-c1">prototype</span> <span class="pl-k">=</span> <span class="pl-c1">Object</span>.<span class="pl-en">create</span>( <span class="pl-smi">Foo</span>.<span class="pl-c1">prototype</span> );

<span class="pl-smi">Bar</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">speak</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
	<span class="pl-en">alert</span>( <span class="pl-s"><span class="pl-pds">"</span>Hello, <span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-c1">this</span>.<span class="pl-en">identify</span>() <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>.<span class="pl-pds">"</span></span> );
};

<span class="pl-k">var</span> b1 <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Bar</span>( <span class="pl-s"><span class="pl-pds">"</span>b1<span class="pl-pds">"</span></span> );
<span class="pl-k">var</span> b2 <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Bar</span>( <span class="pl-s"><span class="pl-pds">"</span>b2<span class="pl-pds">"</span></span> );

<span class="pl-smi">b1</span>.<span class="pl-en">speak</span>();
<span class="pl-smi">b2</span>.<span class="pl-en">speak</span>();</pre></div>
<p>Parent class <code>Foo</code>, inherited by child class <code>Bar</code>, which is then instantiated twice as <code>b1</code> and <code>b2</code>. What we have is <code>b1</code> delegating to <code>Bar.prototype</code> which delegates to <code>Foo.prototype</code>. This should look fairly familiar to you, at this point. Nothing too ground-breaking going on.</p>
<p>Now, let's implement <strong>the exact same functionality</strong> using <em>OLOO</em> style code:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> Foo <span class="pl-k">=</span> {
	<span class="pl-en">init</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">who</span>) {
		<span class="pl-c1">this</span>.<span class="pl-smi">me</span> <span class="pl-k">=</span> who;
	},
	<span class="pl-en">identify</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
		<span class="pl-k">return</span> <span class="pl-s"><span class="pl-pds">"</span>I am <span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-c1">this</span>.<span class="pl-smi">me</span>;
	}
};

<span class="pl-k">var</span> Bar <span class="pl-k">=</span> <span class="pl-c1">Object</span>.<span class="pl-en">create</span>( Foo );

<span class="pl-smi">Bar</span>.<span class="pl-en">speak</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
	<span class="pl-en">alert</span>( <span class="pl-s"><span class="pl-pds">"</span>Hello, <span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-c1">this</span>.<span class="pl-en">identify</span>() <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>.<span class="pl-pds">"</span></span> );
};

<span class="pl-k">var</span> b1 <span class="pl-k">=</span> <span class="pl-c1">Object</span>.<span class="pl-en">create</span>( Bar );
<span class="pl-smi">b1</span>.<span class="pl-en">init</span>( <span class="pl-s"><span class="pl-pds">"</span>b1<span class="pl-pds">"</span></span> );
<span class="pl-k">var</span> b2 <span class="pl-k">=</span> <span class="pl-c1">Object</span>.<span class="pl-en">create</span>( Bar );
<span class="pl-smi">b2</span>.<span class="pl-en">init</span>( <span class="pl-s"><span class="pl-pds">"</span>b2<span class="pl-pds">"</span></span> );

<span class="pl-smi">b1</span>.<span class="pl-en">speak</span>();
<span class="pl-smi">b2</span>.<span class="pl-en">speak</span>();</pre></div>
<p>We take exactly the same advantage of <code>[[Prototype]]</code> delegation from <code>b1</code> to <code>Bar</code> to <code>Foo</code> as we did in the previous snippet between <code>b1</code>, <code>Bar.prototype</code>, and <code>Foo.prototype</code>. <strong>We still have the same 3 objects linked together</strong>.</p>
<p>But, importantly, we've greatly simplified <em>all the other stuff</em> going on, because now we just set up <strong>objects</strong> linked to each other, without needing all the cruft and confusion of things that look (but don't behave!) like classes, with constructors and prototypes and <code>new</code> calls.</p>
<p>Ask yourself: if I can get the same functionality with OLOO style code as I do with "class" style code, but OLOO is simpler and has less things to think about, <strong>isn't OLOO better</strong>?</p>
<p>Let's examine the mental models involved between these two snippets.</p>
<p>First, the class-style code snippet implies this mental model of entities and their relationships:</p>
<p><a target="_blank" rel="noopener noreferrer" href="/getify/You-Dont-Know-JS/blob/master/this%20%26%20object%20prototypes/fig4.png"><img src="/getify/You-Dont-Know-JS/raw/master/this%20%26%20object%20prototypes/fig4.png" style="max-width:100%;"></a></p>
<p>Actually, that's a little unfair/misleading, because it's showing a lot of extra detail that you don't <em>technically</em> need to know at all times (though you <em>do</em> need to understand it!). One take-away is that it's quite a complex series of relationships. But another take-away: if you spend the time to follow those relationship arrows around, <strong>there's an amazing amount of internal consistency</strong> in JS's mechanisms.</p>
<p>For instance, the ability of a JS function to access <code>call(..)</code>, <code>apply(..)</code>, and <code>bind(..)</code> (see Chapter 2) is because functions themselves are objects, and function-objects also have a <code>[[Prototype]]</code> linkage, to the <code>Function.prototype</code> object, which defines those default methods that any function-object can delegate to. JS can do those things, <em>and you can too!</em>.</p>
<p>OK, let's now look at a <em>slightly</em> simplified version of that diagram which is a little more "fair" for comparison -- it shows only the <em>relevant</em> entities and relationships.</p>
<p><a target="_blank" rel="noopener noreferrer" href="/getify/You-Dont-Know-JS/blob/master/this%20%26%20object%20prototypes/fig5.png"><img src="/getify/You-Dont-Know-JS/raw/master/this%20%26%20object%20prototypes/fig5.png" style="max-width:100%;"></a></p>
<p>Still pretty complex, eh? The dotted lines are depicting the implied relationships when you setup the "inheritance" between <code>Foo.prototype</code> and <code>Bar.prototype</code> and haven't yet <em>fixed</em> the <strong>missing</strong> <code>.constructor</code> property reference (see "Constructor Redux" in Chapter 5). Even with those dotted lines removed, the mental model is still an awful lot to juggle every time you work with object linkages.</p>
<p>Now, let's look at the mental model for OLOO-style code:</p>
<p><a target="_blank" rel="noopener noreferrer" href="/getify/You-Dont-Know-JS/blob/master/this%20%26%20object%20prototypes/fig6.png"><img src="/getify/You-Dont-Know-JS/raw/master/this%20%26%20object%20prototypes/fig6.png" style="max-width:100%;"></a></p>
<p>As you can see comparing them, it's quite obvious that OLOO-style code has <em>vastly less stuff</em> to worry about, because OLOO-style code embraces the <strong>fact</strong> that the only thing we ever really cared about was the <strong>objects linked to other objects</strong>.</p>
<p>All the other "class" cruft was a confusing and complex way of getting the same end result. Remove that stuff, and things get much simpler (without losing any capability).</p>
<h2><a id="user-content-classes-vs-objects" class="anchor" aria-hidden="true" href="#classes-vs-objects"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Classes vs. Objects</h2>
<p>We've just seen various theoretical explorations and mental models of "classes" vs. "behavior delegation". But, let's now look at more concrete code scenarios to show how'd you actually use these ideas.</p>
<p>We'll first examine a typical scenario in front-end web dev: creating UI widgets (buttons, drop-downs, etc).</p>
<h3><a id="user-content-widget-classes" class="anchor" aria-hidden="true" href="#widget-classes"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Widget "Classes"</h3>
<p>Because you're probably still so used to the OO design pattern, you'll likely immediately think of this problem domain in terms of a parent class (perhaps called <code>Widget</code>) with all the common base widget behavior, and then child derived classes for specific widget types (like <code>Button</code>).</p>
<p><strong>Note:</strong> We're going to use jQuery here for DOM and CSS manipulation, only because it's a detail we don't really care about for the purposes of our current discussion. None of this code cares which JS framework (jQuery, Dojo, YUI, etc), if any, you might solve such mundane tasks with.</p>
<p>Let's examine how we'd implement the "class" design in classic-style pure JS without any "class" helper library or syntax:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-c"><span class="pl-c">//</span> Parent class</span>
<span class="pl-k">function</span> <span class="pl-en">Widget</span>(<span class="pl-smi">width</span>,<span class="pl-smi">height</span>) {
	<span class="pl-c1">this</span>.<span class="pl-c1">width</span> <span class="pl-k">=</span> width <span class="pl-k">||</span> <span class="pl-c1">50</span>;
	<span class="pl-c1">this</span>.<span class="pl-c1">height</span> <span class="pl-k">=</span> height <span class="pl-k">||</span> <span class="pl-c1">50</span>;
	<span class="pl-c1">this</span>.<span class="pl-smi">$elem</span> <span class="pl-k">=</span> <span class="pl-c1">null</span>;
}

<span class="pl-smi">Widget</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">render</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">$where</span>){
	<span class="pl-k">if</span> (<span class="pl-c1">this</span>.<span class="pl-smi">$elem</span>) {
		<span class="pl-c1">this</span>.<span class="pl-smi">$elem</span>.<span class="pl-en">css</span>( {
			width<span class="pl-k">:</span> <span class="pl-c1">this</span>.<span class="pl-c1">width</span> <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>px<span class="pl-pds">"</span></span>,
			height<span class="pl-k">:</span> <span class="pl-c1">this</span>.<span class="pl-c1">height</span> <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>px<span class="pl-pds">"</span></span>
		} ).<span class="pl-en">appendTo</span>( $where );
	}
};

<span class="pl-c"><span class="pl-c">//</span> Child class</span>
<span class="pl-k">function</span> <span class="pl-en">Button</span>(<span class="pl-smi">width</span>,<span class="pl-smi">height</span>,<span class="pl-smi">label</span>) {
	<span class="pl-c"><span class="pl-c">//</span> "super" constructor call</span>
	<span class="pl-smi">Widget</span>.<span class="pl-c1">call</span>( <span class="pl-c1">this</span>, width, height );
	<span class="pl-c1">this</span>.<span class="pl-c1">label</span> <span class="pl-k">=</span> label <span class="pl-k">||</span> <span class="pl-s"><span class="pl-pds">"</span>Default<span class="pl-pds">"</span></span>;

	<span class="pl-c1">this</span>.<span class="pl-smi">$elem</span> <span class="pl-k">=</span> <span class="pl-en">$</span>( <span class="pl-s"><span class="pl-pds">"</span>&lt;button&gt;<span class="pl-pds">"</span></span> ).<span class="pl-c1">text</span>( <span class="pl-c1">this</span>.<span class="pl-c1">label</span> );
}

<span class="pl-c"><span class="pl-c">//</span> make `Button` "inherit" from `Widget`</span>
<span class="pl-smi">Button</span>.<span class="pl-c1">prototype</span> <span class="pl-k">=</span> <span class="pl-c1">Object</span>.<span class="pl-en">create</span>( <span class="pl-smi">Widget</span>.<span class="pl-c1">prototype</span> );

<span class="pl-c"><span class="pl-c">//</span> override base "inherited" `render(..)`</span>
<span class="pl-smi">Button</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">render</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">$where</span>) {
	<span class="pl-c"><span class="pl-c">//</span> "super" call</span>
	<span class="pl-smi">Widget</span>.<span class="pl-c1">prototype</span>.<span class="pl-smi">render</span>.<span class="pl-c1">call</span>( <span class="pl-c1">this</span>, $where );
	<span class="pl-c1">this</span>.<span class="pl-smi">$elem</span>.<span class="pl-c1">click</span>( <span class="pl-c1">this</span>.<span class="pl-smi">onClick</span>.<span class="pl-en">bind</span>( <span class="pl-c1">this</span> ) );
};

<span class="pl-smi">Button</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">onClick</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">evt</span>) {
	<span class="pl-en">console</span>.<span class="pl-c1">log</span>( <span class="pl-s"><span class="pl-pds">"</span>Button '<span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-c1">this</span>.<span class="pl-c1">label</span> <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>' clicked!<span class="pl-pds">"</span></span> );
};

<span class="pl-en">$</span>( <span class="pl-c1">document</span> ).<span class="pl-en">ready</span>( <span class="pl-k">function</span>(){
	<span class="pl-k">var</span> $body <span class="pl-k">=</span> <span class="pl-en">$</span>( <span class="pl-c1">document</span>.<span class="pl-c1">body</span> );
	<span class="pl-k">var</span> btn1 <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Button</span>( <span class="pl-c1">125</span>, <span class="pl-c1">30</span>, <span class="pl-s"><span class="pl-pds">"</span>Hello<span class="pl-pds">"</span></span> );
	<span class="pl-k">var</span> btn2 <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Button</span>( <span class="pl-c1">150</span>, <span class="pl-c1">40</span>, <span class="pl-s"><span class="pl-pds">"</span>World<span class="pl-pds">"</span></span> );

	<span class="pl-smi">btn1</span>.<span class="pl-en">render</span>( $body );
	<span class="pl-smi">btn2</span>.<span class="pl-en">render</span>( $body );
} );</pre></div>
<p>OO design patterns tell us to declare a base <code>render(..)</code> in the parent class, then override it in our child class, but not to replace it per se, rather to augment the base functionality with button-specific behavior.</p>
<p>Notice the ugliness of <em>explicit pseudo-polymorphism</em> (see Chapter 4) with <code>Widget.call</code> and <code>Widget.prototype.render.call</code> references for faking "super" calls from the child "class" methods back up to the "parent" class base methods. Yuck.</p>
<h4><a id="user-content-es6-class-sugar" class="anchor" aria-hidden="true" href="#es6-class-sugar"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ES6 <code>class</code> sugar</h4>
<p>We cover ES6 <code>class</code> syntax sugar in detail in Appendix A, but let's briefly demonstrate how we'd implement the same code using <code>class</code>:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">class</span> <span class="pl-en">Widget</span> {
	<span class="pl-en">constructor</span>(<span class="pl-smi">width</span>,<span class="pl-smi">height</span>) {
		<span class="pl-c1">this</span>.<span class="pl-c1">width</span> <span class="pl-k">=</span> width <span class="pl-k">||</span> <span class="pl-c1">50</span>;
		<span class="pl-c1">this</span>.<span class="pl-c1">height</span> <span class="pl-k">=</span> height <span class="pl-k">||</span> <span class="pl-c1">50</span>;
		<span class="pl-c1">this</span>.<span class="pl-smi">$elem</span> <span class="pl-k">=</span> <span class="pl-c1">null</span>;
	}
	<span class="pl-en">render</span>(<span class="pl-smi">$where</span>){
		<span class="pl-k">if</span> (<span class="pl-c1">this</span>.<span class="pl-smi">$elem</span>) {
			<span class="pl-c1">this</span>.<span class="pl-smi">$elem</span>.<span class="pl-en">css</span>( {
				width<span class="pl-k">:</span> <span class="pl-c1">this</span>.<span class="pl-c1">width</span> <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>px<span class="pl-pds">"</span></span>,
				height<span class="pl-k">:</span> <span class="pl-c1">this</span>.<span class="pl-c1">height</span> <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>px<span class="pl-pds">"</span></span>
			} ).<span class="pl-en">appendTo</span>( $where );
		}
	}
}

<span class="pl-k">class</span> <span class="pl-en">Button</span> <span class="pl-k">extends</span> <span class="pl-e">Widget</span> {
	<span class="pl-en">constructor</span>(<span class="pl-smi">width</span>,<span class="pl-smi">height</span>,<span class="pl-smi">label</span>) {
		<span class="pl-c1">super</span>( width, height );
		<span class="pl-c1">this</span>.<span class="pl-c1">label</span> <span class="pl-k">=</span> label <span class="pl-k">||</span> <span class="pl-s"><span class="pl-pds">"</span>Default<span class="pl-pds">"</span></span>;
		<span class="pl-c1">this</span>.<span class="pl-smi">$elem</span> <span class="pl-k">=</span> <span class="pl-en">$</span>( <span class="pl-s"><span class="pl-pds">"</span>&lt;button&gt;<span class="pl-pds">"</span></span> ).<span class="pl-c1">text</span>( <span class="pl-c1">this</span>.<span class="pl-c1">label</span> );
	}
	<span class="pl-en">render</span>(<span class="pl-smi">$where</span>) {
		<span class="pl-c1">super</span>.<span class="pl-en">render</span>( $where );
		<span class="pl-c1">this</span>.<span class="pl-smi">$elem</span>.<span class="pl-c1">click</span>( <span class="pl-c1">this</span>.<span class="pl-smi">onClick</span>.<span class="pl-en">bind</span>( <span class="pl-c1">this</span> ) );
	}
	<span class="pl-en">onClick</span>(<span class="pl-smi">evt</span>) {
		<span class="pl-en">console</span>.<span class="pl-c1">log</span>( <span class="pl-s"><span class="pl-pds">"</span>Button '<span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-c1">this</span>.<span class="pl-c1">label</span> <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>' clicked!<span class="pl-pds">"</span></span> );
	}
}

<span class="pl-en">$</span>( <span class="pl-c1">document</span> ).<span class="pl-en">ready</span>( <span class="pl-k">function</span>(){
	<span class="pl-k">var</span> $body <span class="pl-k">=</span> <span class="pl-en">$</span>( <span class="pl-c1">document</span>.<span class="pl-c1">body</span> );
	<span class="pl-k">var</span> btn1 <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Button</span>( <span class="pl-c1">125</span>, <span class="pl-c1">30</span>, <span class="pl-s"><span class="pl-pds">"</span>Hello<span class="pl-pds">"</span></span> );
	<span class="pl-k">var</span> btn2 <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Button</span>( <span class="pl-c1">150</span>, <span class="pl-c1">40</span>, <span class="pl-s"><span class="pl-pds">"</span>World<span class="pl-pds">"</span></span> );

	<span class="pl-smi">btn1</span>.<span class="pl-en">render</span>( $body );
	<span class="pl-smi">btn2</span>.<span class="pl-en">render</span>( $body );
} );</pre></div>
<p>Undoubtedly, a number of the syntax uglies of the previous classical approach have been smoothed over with ES6's <code>class</code>. The presence of a <code>super(..)</code> in particular seems quite nice (though when you dig into it, it's not all roses!).</p>
<p>Despite syntactic improvements, <strong>these are not <em>real</em> classes</strong>, as they still operate on top of the <code>[[Prototype]]</code> mechanism. They suffer from all the same mental-model mismatches we explored in Chapters 4, 5 and thus far in this chapter. Appendix A will expound on the ES6 <code>class</code> syntax and its implications in detail. We'll see why solving syntax hiccups doesn't substantially solve our class confusions in JS, though it makes a valiant effort masquerading as a solution!</p>
<p>Whether you use the classic prototypal syntax or the new ES6 sugar, you've still made a <em>choice</em> to model the problem domain (UI widgets) with "classes". And as the previous few chapters try to demonstrate, this <em>choice</em> in JavaScript is opting you into extra headaches and mental tax.</p>
<h3><a id="user-content-delegating-widget-objects" class="anchor" aria-hidden="true" href="#delegating-widget-objects"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Delegating Widget Objects</h3>
<p>Here's our simpler <code>Widget</code> / <code>Button</code> example, using <strong>OLOO style delegation</strong>:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> Widget <span class="pl-k">=</span> {
	<span class="pl-en">init</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">width</span>,<span class="pl-smi">height</span>){
		<span class="pl-c1">this</span>.<span class="pl-c1">width</span> <span class="pl-k">=</span> width <span class="pl-k">||</span> <span class="pl-c1">50</span>;
		<span class="pl-c1">this</span>.<span class="pl-c1">height</span> <span class="pl-k">=</span> height <span class="pl-k">||</span> <span class="pl-c1">50</span>;
		<span class="pl-c1">this</span>.<span class="pl-smi">$elem</span> <span class="pl-k">=</span> <span class="pl-c1">null</span>;
	},
	<span class="pl-en">insert</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">$where</span>){
		<span class="pl-k">if</span> (<span class="pl-c1">this</span>.<span class="pl-smi">$elem</span>) {
			<span class="pl-c1">this</span>.<span class="pl-smi">$elem</span>.<span class="pl-en">css</span>( {
				width<span class="pl-k">:</span> <span class="pl-c1">this</span>.<span class="pl-c1">width</span> <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>px<span class="pl-pds">"</span></span>,
				height<span class="pl-k">:</span> <span class="pl-c1">this</span>.<span class="pl-c1">height</span> <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>px<span class="pl-pds">"</span></span>
			} ).<span class="pl-en">appendTo</span>( $where );
		}
	}
};

<span class="pl-k">var</span> Button <span class="pl-k">=</span> <span class="pl-c1">Object</span>.<span class="pl-en">create</span>( Widget );

<span class="pl-smi">Button</span>.<span class="pl-en">setup</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">width</span>,<span class="pl-smi">height</span>,<span class="pl-smi">label</span>){
	<span class="pl-c"><span class="pl-c">//</span> delegated call</span>
	<span class="pl-c1">this</span>.<span class="pl-en">init</span>( width, height );
	<span class="pl-c1">this</span>.<span class="pl-c1">label</span> <span class="pl-k">=</span> label <span class="pl-k">||</span> <span class="pl-s"><span class="pl-pds">"</span>Default<span class="pl-pds">"</span></span>;

	<span class="pl-c1">this</span>.<span class="pl-smi">$elem</span> <span class="pl-k">=</span> <span class="pl-en">$</span>( <span class="pl-s"><span class="pl-pds">"</span>&lt;button&gt;<span class="pl-pds">"</span></span> ).<span class="pl-c1">text</span>( <span class="pl-c1">this</span>.<span class="pl-c1">label</span> );
};
<span class="pl-smi">Button</span>.<span class="pl-en">build</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">$where</span>) {
	<span class="pl-c"><span class="pl-c">//</span> delegated call</span>
	<span class="pl-c1">this</span>.<span class="pl-en">insert</span>( $where );
	<span class="pl-c1">this</span>.<span class="pl-smi">$elem</span>.<span class="pl-c1">click</span>( <span class="pl-c1">this</span>.<span class="pl-smi">onClick</span>.<span class="pl-en">bind</span>( <span class="pl-c1">this</span> ) );
};
<span class="pl-smi">Button</span>.<span class="pl-en">onClick</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">evt</span>) {
	<span class="pl-en">console</span>.<span class="pl-c1">log</span>( <span class="pl-s"><span class="pl-pds">"</span>Button '<span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-c1">this</span>.<span class="pl-c1">label</span> <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">"</span>' clicked!<span class="pl-pds">"</span></span> );
};

<span class="pl-en">$</span>( <span class="pl-c1">document</span> ).<span class="pl-en">ready</span>( <span class="pl-k">function</span>(){
	<span class="pl-k">var</span> $body <span class="pl-k">=</span> <span class="pl-en">$</span>( <span class="pl-c1">document</span>.<span class="pl-c1">body</span> );

	<span class="pl-k">var</span> btn1 <span class="pl-k">=</span> <span class="pl-c1">Object</span>.<span class="pl-en">create</span>( Button );
	<span class="pl-smi">btn1</span>.<span class="pl-en">setup</span>( <span class="pl-c1">125</span>, <span class="pl-c1">30</span>, <span class="pl-s"><span class="pl-pds">"</span>Hello<span class="pl-pds">"</span></span> );

	<span class="pl-k">var</span> btn2 <span class="pl-k">=</span> <span class="pl-c1">Object</span>.<span class="pl-en">create</span>( Button );
	<span class="pl-smi">btn2</span>.<span class="pl-en">setup</span>( <span class="pl-c1">150</span>, <span class="pl-c1">40</span>, <span class="pl-s"><span class="pl-pds">"</span>World<span class="pl-pds">"</span></span> );

	<span class="pl-smi">btn1</span>.<span class="pl-en">build</span>( $body );
	<span class="pl-smi">btn2</span>.<span class="pl-en">build</span>( $body );
} );</pre></div>
<p>With this OLOO-style approach, we don't think of <code>Widget</code> as a parent and <code>Button</code> as a child. Rather, <code>Widget</code> <strong>is just an object</strong> and is sort of a utility collection that any specific type of widget might want to delegate to, and <code>Button</code> <strong>is also just a stand-alone object</strong> (with a delegation link to <code>Widget</code>, of course!).</p>
<p>From a design pattern perspective, we <strong>didn't</strong> share the same method name <code>render(..)</code> in both objects, the way classes suggest, but instead we chose different names (<code>insert(..)</code> and <code>build(..)</code>) that were more descriptive of what task each does specifically. The <em>initialization</em> methods are called <code>init(..)</code> and <code>setup(..)</code>, respectively, for the same reasons.</p>
<p>Not only does this delegation design pattern suggest different and more descriptive names (rather than shared and more generic names), but doing so with OLOO happens to avoid the ugliness of the explicit pseudo-polymorphic calls (<code>Widget.call</code> and <code>Widget.prototype.render.call</code>), as you can see by the simple, relative, delegated calls to <code>this.init(..)</code> and <code>this.insert(..)</code>.</p>
<p>Syntactically, we also don't have any constructors, <code>.prototype</code> or <code>new</code> present, as they are, in fact, just unnecessary cruft.</p>
<p>Now, if you're paying close attention, you may notice that what was previously just one call (<code>var btn1 = new Button(..)</code>) is now two calls (<code>var btn1 = Object.create(Button)</code> and <code>btn1.setup(..)</code>). Initially this may seem like a drawback (more code).</p>
<p>However, even this is something that's <strong>a pro of OLOO style code</strong> as compared to classical prototype style code. How?</p>
<p>With class constructors, you are "forced" (not really, but strongly suggested) to do both construction and initialization in the same step. However, there are many cases where being able to do these two steps separately (as you do with OLOO!) is more flexible.</p>
<p>For example, let's say you create all your instances in a pool at the beginning of your program, but you wait to initialize them with specific setup until they are pulled from the pool and used. We showed the two calls happening right next to each other, but of course they can happen at very different times and in very different parts of our code, as needed.</p>
<p><strong>OLOO</strong> supports <em>better</em> the principle of separation of concerns, where creation and initialization are not necessarily conflated into the same operation.</p>
<h2><a id="user-content-simpler-design" class="anchor" aria-hidden="true" href="#simpler-design"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Simpler Design</h2>
<p>In addition to OLOO providing ostensibly simpler (and more flexible!) code, behavior delegation as a pattern can actually lead to simpler code architecture. Let's examine one last example that illustrates how OLOO simplifies your overall design.</p>
<p>The scenario we'll examine is two controller objects, one for handling the login form of a web page, and another for actually handling the authentication (communication) with the server.</p>
<p>We'll need a utility helper for making the Ajax communication to the server. We'll use jQuery (though any framework would do fine), since it handles not only the Ajax for us, but it returns a promise-like answer so that we can listen for the response in our calling code with <code>.then(..)</code>.</p>
<p><strong>Note:</strong> We don't cover Promises here, but we will cover them in a future title of the <em>"You Don't Know JS"</em> series.</p>
<p>Following the typical class design pattern, we'll break up the task into base functionality in a class called <code>Controller</code>, and then we'll derive two child classes, <code>LoginController</code> and <code>AuthController</code>, which both inherit from <code>Controller</code> and specialize some of those base behaviors.</p>
<div class="highlight highlight-source-js"><pre><span class="pl-c"><span class="pl-c">//</span> Parent class</span>
<span class="pl-k">function</span> <span class="pl-en">Controller</span>() {
	<span class="pl-c1">this</span>.<span class="pl-smi">errors</span> <span class="pl-k">=</span> [];
}
<span class="pl-smi">Controller</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">showDialog</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">title</span>,<span class="pl-smi">msg</span>) {
	<span class="pl-c"><span class="pl-c">//</span> display title &amp; message to user in dialog</span>
};
<span class="pl-smi">Controller</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">success</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">msg</span>) {
	<span class="pl-c1">this</span>.<span class="pl-en">showDialog</span>( <span class="pl-s"><span class="pl-pds">"</span>Success<span class="pl-pds">"</span></span>, msg );
};
<span class="pl-smi">Controller</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">failure</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">err</span>) {
	<span class="pl-c1">this</span>.<span class="pl-smi">errors</span>.<span class="pl-c1">push</span>( err );
	<span class="pl-c1">this</span>.<span class="pl-en">showDialog</span>( <span class="pl-s"><span class="pl-pds">"</span>Error<span class="pl-pds">"</span></span>, err );
};</pre></div>
<div class="highlight highlight-source-js"><pre><span class="pl-c"><span class="pl-c">//</span> Child class</span>
<span class="pl-k">function</span> <span class="pl-en">LoginController</span>() {
	<span class="pl-smi">Controller</span>.<span class="pl-c1">call</span>( <span class="pl-c1">this</span> );
}
<span class="pl-c"><span class="pl-c">//</span> Link child class to parent</span>
<span class="pl-smi">LoginController</span>.<span class="pl-c1">prototype</span> <span class="pl-k">=</span> <span class="pl-c1">Object</span>.<span class="pl-en">create</span>( <span class="pl-smi">Controller</span>.<span class="pl-c1">prototype</span> );
<span class="pl-smi">LoginController</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">getUser</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
	<span class="pl-k">return</span> <span class="pl-c1">document</span>.<span class="pl-c1">getElementById</span>( <span class="pl-s"><span class="pl-pds">"</span>login_username<span class="pl-pds">"</span></span> ).<span class="pl-c1">value</span>;
};
<span class="pl-smi">LoginController</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">getPassword</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
	<span class="pl-k">return</span> <span class="pl-c1">document</span>.<span class="pl-c1">getElementById</span>( <span class="pl-s"><span class="pl-pds">"</span>login_password<span class="pl-pds">"</span></span> ).<span class="pl-c1">value</span>;
};
<span class="pl-smi">LoginController</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">validateEntry</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">user</span>,<span class="pl-smi">pw</span>) {
	user <span class="pl-k">=</span> user <span class="pl-k">||</span> <span class="pl-c1">this</span>.<span class="pl-en">getUser</span>();
	pw <span class="pl-k">=</span> pw <span class="pl-k">||</span> <span class="pl-c1">this</span>.<span class="pl-en">getPassword</span>();

	<span class="pl-k">if</span> (<span class="pl-k">!</span>(user <span class="pl-k">&amp;&amp;</span> pw)) {
		<span class="pl-k">return</span> <span class="pl-c1">this</span>.<span class="pl-en">failure</span>( <span class="pl-s"><span class="pl-pds">"</span>Please enter a username &amp; password!<span class="pl-pds">"</span></span> );
	}
	<span class="pl-k">else</span> <span class="pl-k">if</span> (<span class="pl-smi">pw</span>.<span class="pl-c1">length</span> <span class="pl-k">&lt;</span> <span class="pl-c1">5</span>) {
		<span class="pl-k">return</span> <span class="pl-c1">this</span>.<span class="pl-en">failure</span>( <span class="pl-s"><span class="pl-pds">"</span>Password must be 5+ characters!<span class="pl-pds">"</span></span> );
	}

	<span class="pl-c"><span class="pl-c">//</span> got here? validated!</span>
	<span class="pl-k">return</span> <span class="pl-c1">true</span>;
};
<span class="pl-c"><span class="pl-c">//</span> Override to extend base `failure()`</span>
<span class="pl-smi">LoginController</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">failure</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">err</span>) {
	<span class="pl-c"><span class="pl-c">//</span> "super" call</span>
	<span class="pl-smi">Controller</span>.<span class="pl-c1">prototype</span>.<span class="pl-smi">failure</span>.<span class="pl-c1">call</span>( <span class="pl-c1">this</span>, <span class="pl-s"><span class="pl-pds">"</span>Login invalid: <span class="pl-pds">"</span></span> <span class="pl-k">+</span> err );
};</pre></div>
<div class="highlight highlight-source-js"><pre><span class="pl-c"><span class="pl-c">//</span> Child class</span>
<span class="pl-k">function</span> <span class="pl-en">AuthController</span>(<span class="pl-smi">login</span>) {
	<span class="pl-smi">Controller</span>.<span class="pl-c1">call</span>( <span class="pl-c1">this</span> );
	<span class="pl-c"><span class="pl-c">//</span> in addition to inheritance, we also need composition</span>
	<span class="pl-c1">this</span>.<span class="pl-smi">login</span> <span class="pl-k">=</span> login;
}
<span class="pl-c"><span class="pl-c">//</span> Link child class to parent</span>
<span class="pl-smi">AuthController</span>.<span class="pl-c1">prototype</span> <span class="pl-k">=</span> <span class="pl-c1">Object</span>.<span class="pl-en">create</span>( <span class="pl-smi">Controller</span>.<span class="pl-c1">prototype</span> );
<span class="pl-smi">AuthController</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">server</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">url</span>,<span class="pl-smi">data</span>) {
	<span class="pl-k">return</span> <span class="pl-smi">$</span>.<span class="pl-en">ajax</span>( {
		url<span class="pl-k">:</span> url,
		data<span class="pl-k">:</span> data
	} );
};
<span class="pl-smi">AuthController</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">checkAuth</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
	<span class="pl-k">var</span> user <span class="pl-k">=</span> <span class="pl-c1">this</span>.<span class="pl-smi">login</span>.<span class="pl-en">getUser</span>();
	<span class="pl-k">var</span> pw <span class="pl-k">=</span> <span class="pl-c1">this</span>.<span class="pl-smi">login</span>.<span class="pl-en">getPassword</span>();

	<span class="pl-k">if</span> (<span class="pl-c1">this</span>.<span class="pl-smi">login</span>.<span class="pl-en">validateEntry</span>( user, pw )) {
		<span class="pl-c1">this</span>.<span class="pl-en">server</span>( <span class="pl-s"><span class="pl-pds">"</span>/check-auth<span class="pl-pds">"</span></span>,{
			user<span class="pl-k">:</span> user,
			pw<span class="pl-k">:</span> pw
		} )
		.<span class="pl-c1">then</span>( <span class="pl-c1">this</span>.<span class="pl-smi">success</span>.<span class="pl-en">bind</span>( <span class="pl-c1">this</span> ) )
		.<span class="pl-en">fail</span>( <span class="pl-c1">this</span>.<span class="pl-smi">failure</span>.<span class="pl-en">bind</span>( <span class="pl-c1">this</span> ) );
	}
};
<span class="pl-c"><span class="pl-c">//</span> Override to extend base `success()`</span>
<span class="pl-smi">AuthController</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">success</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
	<span class="pl-c"><span class="pl-c">//</span> "super" call</span>
	<span class="pl-smi">Controller</span>.<span class="pl-c1">prototype</span>.<span class="pl-smi">success</span>.<span class="pl-c1">call</span>( <span class="pl-c1">this</span>, <span class="pl-s"><span class="pl-pds">"</span>Authenticated!<span class="pl-pds">"</span></span> );
};
<span class="pl-c"><span class="pl-c">//</span> Override to extend base `failure()`</span>
<span class="pl-smi">AuthController</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">failure</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">err</span>) {
	<span class="pl-c"><span class="pl-c">//</span> "super" call</span>
	<span class="pl-smi">Controller</span>.<span class="pl-c1">prototype</span>.<span class="pl-smi">failure</span>.<span class="pl-c1">call</span>( <span class="pl-c1">this</span>, <span class="pl-s"><span class="pl-pds">"</span>Auth Failed: <span class="pl-pds">"</span></span> <span class="pl-k">+</span> err );
};</pre></div>
<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> auth <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">AuthController</span>(
	<span class="pl-c"><span class="pl-c">//</span> in addition to inheritance, we also need composition</span>
	<span class="pl-k">new</span> <span class="pl-en">LoginController</span>()
);
<span class="pl-smi">auth</span>.<span class="pl-en">checkAuth</span>();</pre></div>
<p>We have base behaviors that all controllers share, which are <code>success(..)</code>, <code>failure(..)</code> and <code>showDialog(..)</code>. Our child classes <code>LoginController</code> and <code>AuthController</code> override <code>failure(..)</code> and <code>success(..)</code> to augment the default base class behavior. Also note that <code>AuthController</code> needs an instance of <code>LoginController</code> to interact with the login form, so that becomes a member data property.</p>
<p>The other thing to mention is that we chose some <em>composition</em> to sprinkle in on top of the inheritance. <code>AuthController</code> needs to know about <code>LoginController</code>, so we instantiate it (<code>new LoginController()</code>) and keep a class member property called <code>this.login</code> to reference it, so that <code>AuthController</code> can invoke behavior on <code>LoginController</code>.</p>
<p><strong>Note:</strong> There <em>might</em> have been a slight temptation to make <code>AuthController</code> inherit from <code>LoginController</code>, or vice versa, such that we had <em>virtual composition</em> through the inheritance chain. But this is a strongly clear example of what's wrong with class inheritance as <em>the</em> model for the problem domain, because neither <code>AuthController</code> nor <code>LoginController</code> are specializing base behavior of the other, so inheritance between them makes little sense except if classes are your only design pattern. Instead, we layered in some simple <em>composition</em> and now they can cooperate, while still both benefiting from the inheritance from the parent base <code>Controller</code>.</p>
<p>If you're familiar with class-oriented (OO) design, this should all look pretty familiar and natural.</p>
<h3><a id="user-content-de-class-ified" class="anchor" aria-hidden="true" href="#de-class-ified"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>De-class-ified</h3>
<p>But, <strong>do we really need to model this problem</strong> with a parent <code>Controller</code> class, two child classes, <strong>and some composition</strong>? Is there a way to take advantage of OLOO-style behavior delegation and have a <em>much</em> simpler design? <strong>Yes!</strong></p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> LoginController <span class="pl-k">=</span> {
	errors<span class="pl-k">:</span> [],
	<span class="pl-en">getUser</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
		<span class="pl-k">return</span> <span class="pl-c1">document</span>.<span class="pl-c1">getElementById</span>( <span class="pl-s"><span class="pl-pds">"</span>login_username<span class="pl-pds">"</span></span> ).<span class="pl-c1">value</span>;
	},
	<span class="pl-en">getPassword</span><span class="pl-k">:</span> <span class="pl-k">function</span>() {
		<span class="pl-k">return</span> <span class="pl-c1">document</span>.<span class="pl-c1">getElementById</span>( <span class="pl-s"><span class="pl-pds">"</span>login_password<span class="pl-pds">"</span></span> ).<span class="pl-c1">value</span>;
	},
	<span class="pl-en">validateEntry</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">user</span>,<span class="pl-smi">pw</span>) {
		user <span class="pl-k">=</span> user <span class="pl-k">||</span> <span class="pl-c1">this</span>.<span class="pl-en">getUser</span>();
		pw <span class="pl-k">=</span> pw <span class="pl-k">||</span> <span class="pl-c1">this</span>.<span class="pl-en">getPassword</span>();

		<span class="pl-k">if</span> (<span class="pl-k">!</span>(user <span class="pl-k">&amp;&amp;</span> pw)) {
			<span class="pl-k">return</span> <span class="pl-c1">this</span>.<span class="pl-en">failure</span>( <span class="pl-s"><span class="pl-pds">"</span>Please enter a username &amp; password!<span class="pl-pds">"</span></span> );
		}
		<span class="pl-k">else</span> <span class="pl-k">if</span> (<span class="pl-smi">pw</span>.<span class="pl-c1">length</span> <span class="pl-k">&lt;</span> <span class="pl-c1">5</span>) {
			<span class="pl-k">return</span> <span class="pl-c1">this</span>.<span class="pl-en">failure</span>( <span class="pl-s"><span class="pl-pds">"</span>Password must be 5+ characters!<span class="pl-pds">"</span></span> );
		}

		<span class="pl-c"><span class="pl-c">//</span> got here? validated!</span>
		<span class="pl-k">return</span> <span class="pl-c1">true</span>;
	},
	<span class="pl-en">showDialog</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">title</span>,<span class="pl-smi">msg</span>) {
		<span class="pl-c"><span class="pl-c">//</span> display success message to user in dialog</span>
	},
	<span class="pl-en">failure</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">err</span>) {
		<span class="pl-c1">this</span>.<span class="pl-smi">errors</span>.<span class="pl-c1">push</span>( err );
		<span class="pl-c1">this</span>.<span class="pl-en">showDialog</span>( <span class="pl-s"><span class="pl-pds">"</span>Error<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Login invalid: <span class="pl-pds">"</span></span> <span class="pl-k">+</span> err );
	}
};</pre></div>
<div class="highlight highlight-source-js"><pre><span class="pl-c"><span class="pl-c">//</span> Link `AuthController` to delegate to `LoginController`</span>
<span class="pl-k">var</span> AuthController <span class="pl-k">=</span> <span class="pl-c1">Object</span>.<span class="pl-en">create</span>( LoginController );

<span class="pl-smi">AuthController</span>.<span class="pl-smi">errors</span> <span class="pl-k">=</span> [];
<span class="pl-smi">AuthController</span>.<span class="pl-en">checkAuth</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
	<span class="pl-k">var</span> user <span class="pl-k">=</span> <span class="pl-c1">this</span>.<span class="pl-en">getUser</span>();
	<span class="pl-k">var</span> pw <span class="pl-k">=</span> <span class="pl-c1">this</span>.<span class="pl-en">getPassword</span>();

	<span class="pl-k">if</span> (<span class="pl-c1">this</span>.<span class="pl-en">validateEntry</span>( user, pw )) {
		<span class="pl-c1">this</span>.<span class="pl-en">server</span>( <span class="pl-s"><span class="pl-pds">"</span>/check-auth<span class="pl-pds">"</span></span>,{
			user<span class="pl-k">:</span> user,
			pw<span class="pl-k">:</span> pw
		} )
		.<span class="pl-c1">then</span>( <span class="pl-c1">this</span>.<span class="pl-smi">accepted</span>.<span class="pl-en">bind</span>( <span class="pl-c1">this</span> ) )
		.<span class="pl-en">fail</span>( <span class="pl-c1">this</span>.<span class="pl-smi">rejected</span>.<span class="pl-en">bind</span>( <span class="pl-c1">this</span> ) );
	}
};
<span class="pl-smi">AuthController</span>.<span class="pl-en">server</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">url</span>,<span class="pl-smi">data</span>) {
	<span class="pl-k">return</span> <span class="pl-smi">$</span>.<span class="pl-en">ajax</span>( {
		url<span class="pl-k">:</span> url,
		data<span class="pl-k">:</span> data
	} );
};
<span class="pl-smi">AuthController</span>.<span class="pl-en">accepted</span> <span class="pl-k">=</span> <span class="pl-k">function</span>() {
	<span class="pl-c1">this</span>.<span class="pl-en">showDialog</span>( <span class="pl-s"><span class="pl-pds">"</span>Success<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Authenticated!<span class="pl-pds">"</span></span> )
};
<span class="pl-smi">AuthController</span>.<span class="pl-en">rejected</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">err</span>) {
	<span class="pl-c1">this</span>.<span class="pl-en">failure</span>( <span class="pl-s"><span class="pl-pds">"</span>Auth Failed: <span class="pl-pds">"</span></span> <span class="pl-k">+</span> err );
};</pre></div>
<p>Since <code>AuthController</code> is just an object (so is <code>LoginController</code>), we don't need to instantiate (like <code>new AuthController()</code>) to perform our task. All we need to do is:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-smi">AuthController</span>.<span class="pl-en">checkAuth</span>();</pre></div>
<p>Of course, with OLOO, if you do need to create one or more additional objects in the delegation chain, that's easy, and still doesn't require anything like class instantiation:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> controller1 <span class="pl-k">=</span> <span class="pl-c1">Object</span>.<span class="pl-en">create</span>( AuthController );
<span class="pl-k">var</span> controller2 <span class="pl-k">=</span> <span class="pl-c1">Object</span>.<span class="pl-en">create</span>( AuthController );</pre></div>
<p>With behavior delegation, <code>AuthController</code> and <code>LoginController</code> are <strong>just objects</strong>, <em>horizontal</em> peers of each other, and are not arranged or related as parents and children in class-orientation. We somewhat arbitrarily chose to have <code>AuthController</code> delegate to <code>LoginController</code> -- it would have been just as valid for the delegation to go the reverse direction.</p>
<p>The main takeaway from this second code listing is that we only have two entities (<code>LoginController</code> and <code>AuthController</code>), <strong>not three</strong> as before.</p>
<p>We didn't need a base <code>Controller</code> class to "share" behavior between the two, because delegation is a powerful enough mechanism to give us the functionality we need. We also, as noted before, don't need to instantiate our classes to work with them, because there are no classes, <strong>just the objects themselves.</strong> Furthermore, there's no need for <em>composition</em> as delegation gives the two objects the ability to cooperate <em>differentially</em> as needed.</p>
<p>Lastly, we avoided the polymorphism pitfalls of class-oriented design by not having the names <code>success(..)</code> and <code>failure(..)</code> be the same on both objects, which would have required ugly explicit pseudopolymorphism. Instead, we called them <code>accepted()</code> and <code>rejected(..)</code> on <code>AuthController</code> -- slightly more descriptive names for their specific tasks.</p>
<p><strong>Bottom line</strong>: we end up with the same capability, but a (significantly) simpler design. That's the power of OLOO-style code and the power of the <em>behavior delegation</em> design pattern.</p>
<h2><a id="user-content-nicer-syntax" class="anchor" aria-hidden="true" href="#nicer-syntax"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Nicer Syntax</h2>
<p>One of the nicer things that makes ES6's <code>class</code> so deceptively attractive (see Appendix A on why to avoid it!) is the short-hand syntax for declaring class methods:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">class</span> <span class="pl-en">Foo</span> {
	<span class="pl-en">methodName</span>() { <span class="pl-c"><span class="pl-c">/*</span> .. <span class="pl-c">*/</span></span> }
}</pre></div>
<p>We get to drop the word <code>function</code> from the declaration, which makes JS developers everywhere cheer!</p>
<p>And you may have noticed and been frustrated that the suggested OLOO syntax above has lots of <code>function</code> appearances, which seems like a bit of a detractor to the goal of OLOO simplification. <strong>But it doesn't have to be that way!</strong></p>
<p>As of ES6, we can use <em>concise method declarations</em> in any object literal, so an object in OLOO style can be declared this way (same short-hand sugar as with <code>class</code> body syntax):</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> LoginController <span class="pl-k">=</span> {
	errors<span class="pl-k">:</span> [],
	<span class="pl-en">getUser</span>() { <span class="pl-c"><span class="pl-c">//</span> Look ma, no `function`!</span>
		<span class="pl-c"><span class="pl-c">//</span> ...</span>
	},
	<span class="pl-en">getPassword</span>() {
		<span class="pl-c"><span class="pl-c">//</span> ...</span>
	}
	<span class="pl-c"><span class="pl-c">//</span> ...</span>
};</pre></div>
<p>About the only difference is that object literals will still require <code>,</code> comma separators between elements whereas <code>class</code> syntax doesn't. Pretty minor concession in the whole scheme of things.</p>
<p>Moreover, as of ES6, the clunkier syntax you use (like for the <code>AuthController</code> definition), where you're assigning properties individually and not using an object literal, can be re-written using an object literal (so that you can use concise methods), and you can just modify that object's <code>[[Prototype]]</code> with <code>Object.setPrototypeOf(..)</code>, like this:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-c"><span class="pl-c">//</span> use nicer object literal syntax w/ concise methods!</span>
<span class="pl-k">var</span> AuthController <span class="pl-k">=</span> {
	errors<span class="pl-k">:</span> [],
	<span class="pl-en">checkAuth</span>() {
		<span class="pl-c"><span class="pl-c">//</span> ...</span>
	},
	<span class="pl-en">server</span>(<span class="pl-smi">url</span>,<span class="pl-smi">data</span>) {
		<span class="pl-c"><span class="pl-c">//</span> ...</span>
	}
	<span class="pl-c"><span class="pl-c">//</span> ...</span>
};

<span class="pl-c"><span class="pl-c">//</span> NOW, link `AuthController` to delegate to `LoginController`</span>
<span class="pl-c1">Object</span>.<span class="pl-en">setPrototypeOf</span>( AuthController, LoginController );</pre></div>
<p>OLOO-style as of ES6, with concise methods, <strong>is a lot friendlier</strong> than it was before (and even then, it was much simpler and nicer than classical prototype-style code). <strong>You don't have to opt for class</strong> (complexity) to get nice clean object syntax!</p>
<h3><a id="user-content-unlexical" class="anchor" aria-hidden="true" href="#unlexical"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Unlexical</h3>
<p>There <em>is</em> one drawback to concise methods that's subtle but important to note. Consider this code:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> Foo <span class="pl-k">=</span> {
	<span class="pl-en">bar</span>() { <span class="pl-c"><span class="pl-c">/*</span>..<span class="pl-c">*/</span></span> },
	<span class="pl-en">baz</span><span class="pl-k">:</span> <span class="pl-k">function</span> <span class="pl-en">baz</span>() { <span class="pl-c"><span class="pl-c">/*</span>..<span class="pl-c">*/</span></span> }
};</pre></div>
<p>Here's the syntactic de-sugaring that expresses how that code will operate:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> Foo <span class="pl-k">=</span> {
	<span class="pl-en">bar</span><span class="pl-k">:</span> <span class="pl-k">function</span>() { <span class="pl-c"><span class="pl-c">/*</span>..<span class="pl-c">*/</span></span> },
	<span class="pl-en">baz</span><span class="pl-k">:</span> <span class="pl-k">function</span> <span class="pl-en">baz</span>() { <span class="pl-c"><span class="pl-c">/*</span>..<span class="pl-c">*/</span></span> }
};</pre></div>
<p>See the difference? The <code>bar()</code> short-hand became an <em>anonymous function expression</em> (<code>function()..</code>) attached to the <code>bar</code> property, because the function object itself has no name identifier. Compare that to the manually specified <em>named function expression</em> (<code>function baz()..</code>) which has a lexical name identifier <code>baz</code> in addition to being attached to a <code>.baz</code> property.</p>
<p>So what? In the <em>"Scope &amp; Closures"</em> title of this <em>"You Don't Know JS"</em> book series, we cover the three main downsides of <em>anonymous function expressions</em> in detail. We'll just briefly repeat them so we can compare to the concise method short-hand.</p>
<p>Lack of a <code>name</code> identifier on an anonymous function:</p>
<ol>
<li>makes debugging stack traces harder</li>
<li>makes self-referencing (recursion, event (un)binding, etc) harder</li>
<li>makes code (a little bit) harder to understand</li>
</ol>
<p>Items 1 and 3 don't apply to concise methods.</p>
<p>Even though the de-sugaring uses an <em>anonymous function expression</em> which normally would have no <code>name</code> in stack traces, concise methods are specified to set the internal <code>name</code> property of the function object accordingly, so stack traces should be able to use it (though that's implementation dependent so not guaranteed).</p>
<p>Item 2 is, unfortunately, <strong>still a drawback to concise methods</strong>. They will not have a lexical identifier to use as a self-reference. Consider:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> Foo <span class="pl-k">=</span> {
	<span class="pl-en">bar</span><span class="pl-k">:</span> <span class="pl-k">function</span>(<span class="pl-smi">x</span>) {
		<span class="pl-k">if</span> (x <span class="pl-k">&lt;</span> <span class="pl-c1">10</span>) {
			<span class="pl-k">return</span> <span class="pl-smi">Foo</span>.<span class="pl-en">bar</span>( x <span class="pl-k">*</span> <span class="pl-c1">2</span> );
		}
		<span class="pl-k">return</span> x;
	},
	<span class="pl-en">baz</span><span class="pl-k">:</span> <span class="pl-k">function</span> <span class="pl-en">baz</span>(<span class="pl-smi">x</span>) {
		<span class="pl-k">if</span> (x <span class="pl-k">&lt;</span> <span class="pl-c1">10</span>) {
			<span class="pl-k">return</span> <span class="pl-en">baz</span>( x <span class="pl-k">*</span> <span class="pl-c1">2</span> );
		}
		<span class="pl-k">return</span> x;
	}
};</pre></div>
<p>The manual <code>Foo.bar(x*2)</code> reference above kind of suffices in this example, but there are many cases where a function wouldn't necessarily be able to do that, such as cases where the function is being shared in delegation across different objects, using <code>this</code> binding, etc. You would want to use a real self-reference, and the function object's <code>name</code> identifier is the best way to accomplish that.</p>
<p>Just be aware of this caveat for concise methods, and if you run into such issues with lack of self-reference, make sure to forgo the concise method syntax <strong>just for that declaration</strong> in favor of the manual <em>named function expression</em> declaration form: <code>baz: function baz(){..}</code>.</p>
<h2><a id="user-content-introspection" class="anchor" aria-hidden="true" href="#introspection"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introspection</h2>
<p>If you've spent much time with class oriented programming (either in JS or other languages), you're probably familiar with <em>type introspection</em>: inspecting an instance to find out what <em>kind</em> of object it is. The primary goal of <em>type introspection</em> with class instances is to reason about the structure/capabilities of the object based on <em>how it was created</em>.</p>
<p>Consider this code which uses <code>instanceof</code> (see Chapter 5) for introspecting on an object <code>a1</code> to infer its capability:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">function</span> <span class="pl-en">Foo</span>() {
	<span class="pl-c"><span class="pl-c">//</span> ...</span>
}
<span class="pl-smi">Foo</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">something</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(){
	<span class="pl-c"><span class="pl-c">//</span> ...</span>
}

<span class="pl-k">var</span> a1 <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Foo</span>();

<span class="pl-c"><span class="pl-c">//</span> later</span>

<span class="pl-k">if</span> (a1 <span class="pl-k">instanceof</span> Foo) {
	<span class="pl-smi">a1</span>.<span class="pl-en">something</span>();
}</pre></div>
<p>Because <code>Foo.prototype</code> (not <code>Foo</code>!) is in the <code>[[Prototype]]</code> chain (see Chapter 5) of <code>a1</code>, the <code>instanceof</code> operator (confusingly) pretends to tell us that <code>a1</code> is an instance of the <code>Foo</code> "class". With this knowledge, we then assume that <code>a1</code> has the capabilities described by the <code>Foo</code> "class".</p>
<p>Of course, there is no <code>Foo</code> class, only a plain old normal function <code>Foo</code>, which happens to have a reference to an arbitrary object (<code>Foo.prototype</code>) that <code>a1</code> happens to be delegation-linked to. By its syntax, <code>instanceof</code> pretends to be inspecting the relationship between <code>a1</code> and <code>Foo</code>, but it's actually telling us whether <code>a1</code> and (the arbitrary object referenced by) <code>Foo.prototype</code> are related.</p>
<p>The semantic confusion (and indirection) of <code>instanceof</code> syntax means that to use <code>instanceof</code>-based introspection to ask if object <code>a1</code> is related to the capabilities object in question, you <em>have to</em> have a function that holds a reference to that object -- you can't just directly ask if the two objects are related.</p>
<p>Recall the abstract <code>Foo</code> / <code>Bar</code> / <code>b1</code> example from earlier in this chapter, which we'll abbreviate here:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">function</span> <span class="pl-en">Foo</span>() { <span class="pl-c"><span class="pl-c">/*</span> .. <span class="pl-c">*/</span></span> }
<span class="pl-smi">Foo</span>.<span class="pl-c1">prototype</span><span class="pl-k">...</span>

<span class="pl-k">function</span> <span class="pl-en">Bar</span>() { <span class="pl-c"><span class="pl-c">/*</span> .. <span class="pl-c">*/</span></span> }
<span class="pl-smi">Bar</span>.<span class="pl-c1">prototype</span> <span class="pl-k">=</span> <span class="pl-c1">Object</span>.<span class="pl-en">create</span>( <span class="pl-smi">Foo</span>.<span class="pl-c1">prototype</span> );

<span class="pl-k">var</span> b1 <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Bar</span>( <span class="pl-s"><span class="pl-pds">"</span>b1<span class="pl-pds">"</span></span> );</pre></div>
<p>For <em>type introspection</em> purposes on the entities in that example, using <code>instanceof</code> and <code>.prototype</code> semantics, here are the various checks you might need to perform:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-c"><span class="pl-c">//</span> relating `Foo` and `Bar` to each other</span>
<span class="pl-smi">Bar</span>.<span class="pl-c1">prototype</span> <span class="pl-k">instanceof</span> Foo; <span class="pl-c"><span class="pl-c">//</span> true</span>
<span class="pl-c1">Object</span>.<span class="pl-en">getPrototypeOf</span>( <span class="pl-smi">Bar</span>.<span class="pl-c1">prototype</span> ) <span class="pl-k">===</span> <span class="pl-smi">Foo</span>.<span class="pl-c1">prototype</span>; <span class="pl-c"><span class="pl-c">//</span> true</span>
<span class="pl-smi">Foo</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">isPrototypeOf</span>( <span class="pl-smi">Bar</span>.<span class="pl-c1">prototype</span> ); <span class="pl-c"><span class="pl-c">//</span> true</span>

<span class="pl-c"><span class="pl-c">//</span> relating `b1` to both `Foo` and `Bar`</span>
b1 <span class="pl-k">instanceof</span> Foo; <span class="pl-c"><span class="pl-c">//</span> true</span>
b1 <span class="pl-k">instanceof</span> Bar; <span class="pl-c"><span class="pl-c">//</span> true</span>
<span class="pl-c1">Object</span>.<span class="pl-en">getPrototypeOf</span>( b1 ) <span class="pl-k">===</span> <span class="pl-smi">Bar</span>.<span class="pl-c1">prototype</span>; <span class="pl-c"><span class="pl-c">//</span> true</span>
<span class="pl-smi">Foo</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">isPrototypeOf</span>( b1 ); <span class="pl-c"><span class="pl-c">//</span> true</span>
<span class="pl-smi">Bar</span>.<span class="pl-c1">prototype</span>.<span class="pl-en">isPrototypeOf</span>( b1 ); <span class="pl-c"><span class="pl-c">//</span> true</span></pre></div>
<p>It's fair to say that some of that kinda sucks. For instance, intuitively (with classes) you might want to be able to say something like <code>Bar instanceof Foo</code> (because it's easy to mix up what "instance" means to think it includes "inheritance"), but that's not a sensible comparison in JS. You have to do <code>Bar.prototype instanceof Foo</code> instead.</p>
<p>Another common, but perhaps less robust, pattern for <em>type introspection</em>, which many devs seem to prefer over <code>instanceof</code>, is called "duck typing". This term comes from the adage, "if it looks like a duck, and it quacks like a duck, it must be a duck".</p>
<p>Example:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">if</span> (<span class="pl-smi">a1</span>.<span class="pl-smi">something</span>) {
	<span class="pl-smi">a1</span>.<span class="pl-en">something</span>();
}</pre></div>
<p>Rather than inspecting for a relationship between <code>a1</code> and an object that holds the delegatable <code>something()</code> function, we assume that the test for <code>a1.something</code> passing means <code>a1</code> has the capability to call <code>.something()</code> (regardless of if it found the method directly on <code>a1</code> or delegated to some other object). In and of itself, that assumption isn't so risky.</p>
<p>But "duck typing" is often extended to make <strong>other assumptions about the object's capabilities</strong> besides what's being tested, which of course introduces more risk (aka, brittle design) into the test.</p>
<p>One notable example of "duck typing" comes with ES6 Promises (which as an earlier note explained are not being covered in this book).</p>
<p>For various reasons, there's a need to determine if any arbitrary object reference <em>is a Promise</em>, but the way that test is done is to check if the object happens to have a <code>then()</code> function present on it. In other words, <strong>if any object</strong> happens to have a <code>then()</code> method, ES6 Promises will assume unconditionally that the object <strong>is a "thenable"</strong> and therefore will expect it to behave conformantly to all standard behaviors of Promises.</p>
<p>If you have any non-Promise object that happens for whatever reason to have a <code>then()</code> method on it, you are strongly advised to keep it far away from the ES6 Promise mechanism to avoid broken assumptions.</p>
<p>That example clearly illustrates the perils of "duck typing". You should only use such approaches sparingly and in controlled conditions.</p>
<p>Turning our attention once again back to OLOO-style code as presented here in this chapter, <em>type introspection</em> turns out to be much cleaner. Let's recall (and abbreviate) the <code>Foo</code> / <code>Bar</code> / <code>b1</code> OLOO example from earlier in the chapter:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> Foo <span class="pl-k">=</span> { <span class="pl-c"><span class="pl-c">/*</span> .. <span class="pl-c">*/</span></span> };

<span class="pl-k">var</span> Bar <span class="pl-k">=</span> <span class="pl-c1">Object</span>.<span class="pl-en">create</span>( Foo );
Bar<span class="pl-k">...</span>

<span class="pl-k">var</span> b1 <span class="pl-k">=</span> <span class="pl-c1">Object</span>.<span class="pl-en">create</span>( Bar );</pre></div>
<p>Using this OLOO approach, where all we have are plain objects that are related via <code>[[Prototype]]</code> delegation, here's the quite simplified <em>type introspection</em> we might use:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-c"><span class="pl-c">//</span> relating `Foo` and `Bar` to each other</span>
<span class="pl-smi">Foo</span>.<span class="pl-en">isPrototypeOf</span>( Bar ); <span class="pl-c"><span class="pl-c">//</span> true</span>
<span class="pl-c1">Object</span>.<span class="pl-en">getPrototypeOf</span>( Bar ) <span class="pl-k">===</span> Foo; <span class="pl-c"><span class="pl-c">//</span> true</span>

<span class="pl-c"><span class="pl-c">//</span> relating `b1` to both `Foo` and `Bar`</span>
<span class="pl-smi">Foo</span>.<span class="pl-en">isPrototypeOf</span>( b1 ); <span class="pl-c"><span class="pl-c">//</span> true</span>
<span class="pl-smi">Bar</span>.<span class="pl-en">isPrototypeOf</span>( b1 ); <span class="pl-c"><span class="pl-c">//</span> true</span>
<span class="pl-c1">Object</span>.<span class="pl-en">getPrototypeOf</span>( b1 ) <span class="pl-k">===</span> Bar; <span class="pl-c"><span class="pl-c">//</span> true</span></pre></div>
<p>We're not using <code>instanceof</code> anymore, because it's confusingly pretending to have something to do with classes. Now, we just ask the (informally stated) question, "are you <em>a</em> prototype of me?" There's no more indirection necessary with stuff like <code>Foo.prototype</code> or the painfully verbose <code>Foo.prototype.isPrototypeOf(..)</code>.</p>
<p>I think it's fair to say these checks are significantly less complicated/confusing than the previous set of introspection checks. <strong>Yet again, we see that OLOO is simpler than (but with all the same power of) class-style coding in JavaScript.</strong></p>
<h2><a id="user-content-review-tldr" class="anchor" aria-hidden="true" href="#review-tldr"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Review (TL;DR)</h2>
<p>Classes and inheritance are a design pattern you can <em>choose</em>, or <em>not choose</em>, in your software architecture. Most developers take for granted that classes are the only (proper) way to organize code, but here we've seen there's another less-commonly talked about pattern that's actually quite powerful: <strong>behavior delegation</strong>.</p>
<p>Behavior delegation suggests objects as peers of each other, which delegate amongst themselves, rather than parent and child class relationships. JavaScript's <code>[[Prototype]]</code> mechanism is, by its very designed nature, a behavior delegation mechanism. That means we can either choose to struggle to implement class mechanics on top of JS (see Chapters 4 and 5), or we can just embrace the natural state of <code>[[Prototype]]</code> as a delegation mechanism.</p>
<p>When you design code with objects only, not only does it simplify the syntax you use, but it can actually lead to simpler code architecture design.</p>
<p><strong>OLOO</strong> (objects-linked-to-other-objects) is a code style which creates and relates objects directly without the abstraction of classes. OLOO quite naturally implements <code>[[Prototype]]</code>-based behavior delegation.</p>
</article>
  </div>

  </div>

  <details class="details-reset details-overlay details-overlay-dark">
    <summary data-hotkey="l" aria-label="Jump to line"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast linejump" aria-label="Jump to line">
      <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="js-jump-to-line-form Box-body d-flex" action="" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input class="form-control flex-auto mr-3 linejump-input js-jump-to-line-field" type="text" placeholder="Jump to line&hellip;" aria-label="Jump to line" autofocus>
        <button type="submit" class="btn" data-close-dialog>Go</button>
</form>    </details-dialog>
  </details>


  </div>
  <div class="modal-backdrop js-touch-events"></div>
</div>

    </div>
  </div>

  </div>

        
<div class="footer container-lg px-3" role="contentinfo">
  <div class="position-relative d-flex flex-justify-between pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <ul class="list-style-none d-flex flex-wrap ">
      <li class="mr-3">&copy; 2018 <span title="0.23648s from unicorn-65f99bcd46-wlr9d">GitHub</span>, Inc.</li>
        <li class="mr-3"><a data-ga-click="Footer, go to terms, text:terms" href="https://github.com/site/terms">Terms</a></li>
        <li class="mr-3"><a data-ga-click="Footer, go to privacy, text:privacy" href="https://github.com/site/privacy">Privacy</a></li>
        <li class="mr-3"><a href="https://help.github.com/articles/github-security/" data-ga-click="Footer, go to security, text:security">Security</a></li>
        <li class="mr-3"><a href="https://status.github.com/" data-ga-click="Footer, go to status, text:status">Status</a></li>
        <li><a data-ga-click="Footer, go to help, text:help" href="https://help.github.com">Help</a></li>
    </ul>

    <a aria-label="Homepage" title="GitHub" class="footer-octicon mr-lg-4" href="https://github.com">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg>
</a>
   <ul class="list-style-none d-flex flex-wrap ">
        <li class="mr-3"><a data-ga-click="Footer, go to contact, text:contact" href="https://github.com/contact">Contact GitHub</a></li>
        <li class="mr-3"><a href="https://github.com/pricing" data-ga-click="Footer, go to Pricing, text:Pricing">Pricing</a></li>
      <li class="mr-3"><a href="https://developer.github.com" data-ga-click="Footer, go to api, text:api">API</a></li>
      <li class="mr-3"><a href="https://training.github.com" data-ga-click="Footer, go to training, text:training">Training</a></li>
        <li class="mr-3"><a href="https://blog.github.com" data-ga-click="Footer, go to blog, text:blog">Blog</a></li>
        <li><a data-ga-click="Footer, go to about, text:about" href="https://github.com/about">About</a></li>

    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>
</div>



  <div id="ajax-error-message" class="ajax-error-message flash flash-error">
    <svg class="octicon octicon-alert" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg>
    <button type="button" class="flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
      <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"/></svg>
    </button>
    You can’t perform that action at this time.
  </div>


    <script crossorigin="anonymous" integrity="sha512-RJ1ufbxsSbKjRCyYvinsPNKvTBvcvvKUvEOJ8g+GjtWI5SuRr+QPBlZcvRDws4H9YwAgdQFcGxfL8UbwEfdI7A==" type="application/javascript" src="https://assets-cdn.github.com/assets/compat-daf14de28fadf1e2bc40d100cb773e2b.js"></script>
    <script crossorigin="anonymous" integrity="sha512-IC5Ai6c7cUBfMx54JUAsIjA7VroipzkizlZ8F6/0efsGGyZStweZV7bX9bxSFL07nUNLfwrKSEysVIijX+CeUw==" type="application/javascript" src="https://assets-cdn.github.com/assets/frameworks-5874e38105ec062c740350eeb96bdd8a.js"></script>
    
    <script crossorigin="anonymous" async="async" integrity="sha512-Y0wWbyMvuM4AncqCZ3JmN2XZmX623PfWR2gZgiD2zI2cCqaCpRQyKEm2eCeDhYx4zHiXIhZQW8XCbXYxfs8ZKA==" type="application/javascript" src="https://assets-cdn.github.com/assets/github-d08b5457fa55c9386abe7ed707d05017.js"></script>
    
    
    
  <div class="js-stale-session-flash stale-session-flash flash flash-warn flash-banner d-none">
    <svg class="octicon octicon-alert" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg>
    <span class="signed-in-tab-flash">You signed in with another tab or window. <a href="">Reload</a> to refresh your session.</span>
    <span class="signed-out-tab-flash">You signed out in another tab or window. <a href="">Reload</a> to refresh your session.</span>
  </div>
  <div class="facebox" id="facebox" style="display:none;">
  <div class="facebox-popup">
    <div class="facebox-content" role="dialog" aria-labelledby="facebox-header" aria-describedby="facebox-description">
    </div>
    <button type="button" class="facebox-close js-facebox-close" aria-label="Close modal">
      <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"/></svg>
    </button>
  </div>
</div>

  <template id="site-details-dialog">
  <details class="details-reset details-overlay details-overlay-dark lh-default text-gray-dark" open>
    <summary aria-haspopup="dialog" aria-label="Close dialog"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast">
      <button class="Box-btn-octicon m-0 btn-octicon position-absolute right-0 top-0" type="button" aria-label="Close dialog" data-close-dialog>
        <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"/></svg>
      </button>
      <div class="octocat-spinner my-6 js-details-dialog-spinner"></div>
    </details-dialog>
  </details>
</template>

  <div class="Popover js-hovercard-content position-absolute" style="display: none; outline: none;" tabindex="0">
  <div class="Popover-message Popover-message--bottom-left Popover-message--large Box box-shadow-large" style="width:360px;">
  </div>
</div>

<div id="hovercard-aria-description" class="sr-only">
  Press h to open a hovercard with more details.
</div>


  </body>
</html>

